<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brainrot Clicker - Logan Beggs Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: white;
            font-family: 'Comic Sans MS', 'Arial Rounded MT Bold', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 20px 0;
            background: rgba(255, 107, 107, 0.2);
            border-radius: 20px;
            margin-bottom: 25px;
            border: 4px solid #ff6b6b;
            box-shadow: 0 0 40px rgba(255, 107, 107, 0.4);
            position: relative;
            overflow: hidden;
        }

        h1 {
            font-size: 4em;
            background: linear-gradient(45deg, #ff6b6b, #ffd93d, #6bcf7f);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 30px rgba(255, 107, 107, 0.5);
            margin-bottom: 5px;
            animation: titleGlow 3s infinite alternate;
        }

        @keyframes titleGlow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        .creator {
            font-size: 1.2em;
            color: #6bcf7f;
            font-style: italic;
            margin-bottom: 10px;
        }

        .tagline {
            font-size: 1.3em;
            color: #ffd93d;
            font-weight: bold;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .tab-button {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: 2px solid #9d4edd;
            padding: 12px 30px;
            font-size: 1.3em;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            min-width: 180px;
        }

        .tab-button:hover {
            transform: scale(1.05);
            background: rgba(157, 78, 221, 0.3);
        }

        .tab-button.active {
            background: linear-gradient(45deg, #9d4edd, #ff6b6b);
            box-shadow: 0 0 25px rgba(157, 78, 221, 0.6);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .game-area {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            margin-bottom: 25px;
        }

        .clicker-section {
            flex: 1;
            min-width: 350px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 25px;
            padding: 25px;
            border: 3px solid #4d96ff;
            box-shadow: 0 0 25px rgba(77, 150, 255, 0.4);
        }

        .brainrot-display {
            width: 350px;
            height: 350px;
            margin: 0 auto 25px;
            position: relative;
        }

        #mainIcon {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff6b6b, #4d96ff);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8em;
            cursor: pointer;
            user-select: none;
            transition: transform 0.1s, filter 0.3s;
            border: 15px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 60px rgba(255, 107, 107, 0.6);
        }

        #mainIcon:active {
            transform: scale(0.92);
        }

        .stats-section {
            flex: 1;
            min-width: 350px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 25px;
            padding: 25px;
            border: 3px solid #6bcf7f;
            box-shadow: 0 0 25px rgba(107, 207, 127, 0.4);
        }

        .stat {
            display: flex;
            justify-content: space-between;
            margin: 12px 0;
            padding: 12px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            transition: background 0.3s;
        }

        .stat:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #ffd93d;
        }

        .shop-section {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 25px;
            padding: 25px;
            border: 3px solid #9d4edd;
            box-shadow: 0 0 25px rgba(157, 78, 221, 0.4);
            margin-bottom: 25px;
        }

        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .upgrade-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            opacity: 0.5;
            position: relative;
        }

        .upgrade-item.unlocked {
            opacity: 1;
            cursor: pointer;
        }

        .upgrade-item.locked::before {
            content: "üîí";
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.5em;
        }

        .upgrade-item.unlocked:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ff6b6b;
            transform: translateY(-8px);
        }

        .upgrade-item.bought {
            background: rgba(107, 207, 127, 0.2);
            border-color: #6bcf7f;
        }

        .upgrade-name {
            font-size: 1.5em;
            color: #4d96ff;
            margin-bottom: 8px;
        }

        .upgrade-desc {
            color: #ffd93d;
            margin-bottom: 10px;
            font-size: 0.95em;
            min-height: 40px;
        }

        .upgrade-cost {
            color: #ff6b6b;
            font-weight: bold;
            font-size: 1.3em;
            margin-bottom: 8px;
        }

        .upgrade-requirement {
            color: #9d4edd;
            font-size: 0.9em;
            margin-bottom: 8px;
        }

        .upgrade-count {
            color: #6bcf7f;
            font-weight: bold;
            margin-top: 8px;
            font-size: 1.1em;
        }

        .potions-section {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 25px;
            padding: 25px;
            border: 3px solid #9d4edd;
            box-shadow: 0 0 25px rgba(157, 78, 221, 0.4);
            margin-bottom: 25px;
        }

        .chest-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .chest-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .chest-item:hover:not(.disabled) {
            transform: translateY(-10px);
            border-color: #ffd93d;
            box-shadow: 0 10px 30px rgba(255, 215, 61, 0.3);
        }

        .chest-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .chest-name {
            font-size: 2em;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .wood-chest { border-color: #8B4513; }
        .silver-chest { border-color: #C0C0C0; }
        .gold-chest { border-color: #FFD700; }
        .diamond-chest { border-color: #4d96ff; }
        .supreme-chest { border-color: #ff6b6b; }
        .dark-supreme-chest { border-color: #9d4edd; }

        .chest-cost {
            font-size: 1.4em;
            color: #ff6b6b;
            font-weight: bold;
            margin: 15px 0;
        }

        .chest-odds {
            font-size: 0.9em;
            color: #ffd93d;
            margin: 10px 0;
            text-align: left;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 10px;
        }

        .chest-rewards {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px dashed rgba(255, 255, 255, 0.2);
        }

        .inventory-section {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            padding: 20px;
            margin-top: 25px;
            border: 3px solid #6bcf7f;
            box-shadow: 0 0 25px rgba(107, 207, 127, 0.4);
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .inventory-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid;
            transition: all 0.3s;
            cursor: pointer;
        }

        .inventory-item:hover {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 0.2);
        }

        .inventory-item-name {
            font-size: 1.2em;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .inventory-item-count {
            font-size: 1.5em;
            color: #ffd93d;
            font-weight: bold;
        }

        .inventory-item-use {
            margin-top: 8px;
            padding: 5px 10px;
            background: #4d96ff;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }

        .inventory-item-use:hover {
            background: #6bcf7f;
        }

        .modes-section {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            padding: 20px;
            margin-top: 25px;
            border: 3px solid #ff6b6b;
            box-shadow: 0 0 25px rgba(255, 107, 107, 0.4);
        }

        .modes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .boosts-section {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            padding: 20px;
            margin-top: 25px;
            border: 3px solid #9d4edd;
            box-shadow: 0 0 25px rgba(157, 78, 221, 0.4);
        }

        .active-boosts {
            margin-top: 15px;
        }

        .boost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border-left: 5px solid;
        }

        .boost-timer {
            font-weight: bold;
            color: #ff6b6b;
            font-size: 1.2em;
        }

        .effects-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .click-effect {
            position: absolute;
            font-size: 2.2em;
            font-weight: bold;
            animation: floatUp 1.2s forwards;
            pointer-events: none;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(1) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(-120px) scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        .brainrot-particle {
            position: absolute;
            width: 24px;
            height: 24px;
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            border-radius: 50%;
            animation: particleFloat 2.5s forwards;
            pointer-events: none;
        }

        @keyframes particleFloat {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }

        .prestige-section {
            text-align: center;
            margin-top: 25px;
            padding: 25px;
            background: linear-gradient(135deg, rgba(157, 78, 221, 0.3), rgba(255, 215, 61, 0.3));
            border-radius: 20px;
            border: 3px solid #9d4edd;
        }

        #prestigeBtn {
            background: linear-gradient(45deg, #9d4edd, #ff6b6b);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 1.5em;
            border-radius: 60px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 15px;
            box-shadow: 0 10px 25px rgba(157, 78, 221, 0.4);
        }

        #prestigeBtn:hover:not(:disabled) {
            transform: scale(1.12);
            box-shadow: 0 15px 35px rgba(157, 78, 221, 0.6);
        }

        #prestigeBtn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .prestige-icon-info {
            margin-top: 15px;
            color: #ffd93d;
            font-size: 1.1em;
        }

        .prestige-icons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .prestige-icon {
            font-size: 2.5em;
            opacity: 0.3;
            transition: opacity 0.3s;
        }

        .prestige-icon.active {
            opacity: 1;
            transform: scale(1.2);
            filter: drop-shadow(0 0 10px currentColor);
        }

        .mode-buttons-container {
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 1001;
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: flex-end;
        }

        .mode-button {
            background: linear-gradient(45deg, #ff0000, #ffff00, #00ff00);
            color: black;
            border: none;
            padding: 15px 30px;
            font-size: 1.3em;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            animation: modePulse 2s infinite;
            min-width: 250px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .mode-button.logan-mode {
            background: linear-gradient(45deg, #ff0000, #ffff00, #00ff00);
        }

        .mode-button.gang-mode {
            background: linear-gradient(45deg, #ff6b6b, #ffd93d, #ff6b6b);
            animation: gangPulse 1.5s infinite;
        }

        .mode-button.untouchable-mode {
            background: linear-gradient(45deg, #4d96ff, #9d4edd, #4d96ff);
            animation: untouchablePulse 1.2s infinite;
        }

        .mode-button.dark-supreme-mode {
            background: linear-gradient(45deg, #9d4edd, #ff6b6b, #9d4edd);
            animation: darkSupremePulse 1s infinite;
        }

        .mode-button:hover:not(:disabled) {
            animation: none;
            transform: scale(1.1) rotate(3deg);
        }

        .mode-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            animation: none;
        }

        .mode-button.active {
            filter: brightness(1.5);
            transform: scale(1.05);
            box-shadow: 0 0 30px currentColor;
        }

        @keyframes modePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes gangPulse {
            0%, 100% { transform: scale(1); filter: hue-rotate(0deg); }
            50% { transform: scale(1.05); filter: hue-rotate(90deg); }
        }

        @keyframes untouchablePulse {
            0%, 100% { transform: scale(1); box-shadow: 0 5px 20px #4d96ff; }
            50% { transform: scale(1.05); box-shadow: 0 5px 30px #9d4edd; }
        }

        @keyframes darkSupremePulse {
            0%, 100% { transform: scale(1); box-shadow: 0 5px 20px #9d4edd; }
            50% { transform: scale(1.05); box-shadow: 0 5px 40px #ff6b6b; }
        }

        .achievement-popup {
            position: fixed;
            top: 25px;
            right: 25px;
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            color: black;
            padding: 18px;
            border-radius: 15px;
            animation: slideIn 0.5s, slideOut 0.5s 3s forwards;
            font-weight: bold;
            z-index: 1002;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .brainrot-meter {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
        }

        .brainrot-fill {
            height: 100%;
            background: linear-gradient(90deg, #4d96ff, #9d4edd);
            border-radius: 10px;
            transition: width 0.5s;
            position: relative;
            overflow: hidden;
        }

        .brainrot-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .reset-button {
            position: fixed;
            top: 25px;
            left: 25px;
            z-index: 1001;
        }

        #resetBtn {
            background: linear-gradient(45deg, #ff0000, #ff6b6b);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1em;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        #resetBtn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
        }

        @media (max-width: 900px) {
            .game-area {
                flex-direction: column;
            }
            
            .brainrot-display {
                width: 280px;
                height: 280px;
            }
            
            h1 {
                font-size: 2.8em;
            }
            
            #mainIcon {
                font-size: 6em;
            }
            
            .tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .mode-buttons-container {
                position: static;
                margin-top: 20px;
                align-items: center;
            }
            
            .mode-button {
                min-width: 280px;
            }
            
            .reset-button {
                position: static;
                text-align: center;
                margin-bottom: 15px;
            }
        }

        @media (max-width: 600px) {
            .shop-grid, .chest-grid, .inventory-grid, .modes-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 15px;
            }
            
            .mode-button {
                min-width: 250px;
                padding: 12px 20px;
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>
    <div class="effects-container" id="effects"></div>

    <div class="reset-button">
        <button id="resetBtn" onclick="resetGameData()">RESET GAME DATA</button>
    </div>

    <div class="container">
        <header>
            <h1>üß† BRAINROT CLICKER üß†</h1>
            <div class="creator">Made by Logan Beggs</div>
            <p class="tagline">Click to rot your brain. Prestige to transcend.</p>
            
            <div class="brainrot-meter">
                <div class="brainrot-fill" id="brainrotFill" style="width: 0%"></div>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('upgrades')">UPGRADES</button>
            <button class="tab-button" onclick="switchTab('potions')">POTIONS</button>
        </div>

        <div class="tab-content active" id="upgradesTab">
            <div class="game-area">
                <div class="clicker-section">
                    <h2>üß† CLICK THE BRAINROT üß†</h2>
                    <div class="brainrot-display">
                        <div id="mainIcon" onclick="clickBrainrot()">
                            <!-- Icon changes with prestige -->
                        </div>
                    </div>
                    <div class="stats">
                        <div class="stat">
                            <span>Brainrot Per Click:</span>
                            <span class="stat-value" id="clickPower">1</span>
                        </div>
                        <div class="stat">
                            <span>Brainrot Per Second:</span>
                            <span class="stat-value" id="bps">0</span>
                        </div>
                    </div>
                </div>

                <div class="stats-section">
                    <h2>üìä BRAINROT STATS üìä</h2>
                    <div class="stat">
                        <span>Current Brainrot:</span>
                        <span class="stat-value" id="currentBrainrot">0</span>
                    </div>
                    <div class="stat">
                        <span>Total Brainrot (Run):</span>
                        <span class="stat-value" id="totalBrainrot">0</span>
                    </div>
                    <div class="stat">
                        <span>Lifetime Brainrot:</span>
                        <span class="stat-value" id="lifetimeBrainrot">0</span>
                    </div>
                    <div class="stat">
                        <span>Clicks Made:</span>
                        <span class="stat-value" id="totalClicks">0</span>
                    </div>
                    <div class="stat">
                        <span>Prestige Level:</span>
                        <span class="stat-value" id="prestigeLevel">0</span>
                    </div>
                    <div class="stat">
                        <span>2x Multipliers:</span>
                        <span class="stat-value" id="buyableMultiplier">1x</span>
                    </div>
                    <div class="stat">
                        <span>Prestige Multiplier:</span>
                        <span class="stat-value" id="prestigeMultiplierDisplay">1x</span>
                    </div>
                    <div class="stat">
                        <span>Total Multiplier:</span>
                        <span class="stat-value" id="totalMultiplier">1x</span>
                    </div>
                </div>
            </div>

            <div class="shop-section">
                <h2>üõí BRAINROT UPGRADES üõí</h2>
                <p style="color: #ffd93d; text-align: center; margin-bottom: 15px;">Unlocks at 1.5x cost. 2x Multipliers reset on prestige!</p>
                <div class="shop-grid" id="upgradesGrid">
                    <!-- Upgrades will be generated by JavaScript -->
                </div>
            </div>

            <div class="prestige-section">
                <h2>‚≠ê PRESTIGE SYSTEM ‚≠ê</h2>
                <p>Reset everything for exponential multiplier increases!</p>
                <p style="color: #ff6b6b; font-weight: bold;">‚ö†Ô∏è WARNING: Prestige resets ALL upgrades including 2x multipliers!</p>
                <p>Current Requirement: <span id="prestigeRequirement" style="color:#ffd93d; font-weight:bold;">1,000,000</span> Brainrot</p>
                <p class="prestige-icon-info">Current Prestige Multiplier: <span id="currentMultiplier" style="color:#ff6b6b; font-weight:bold;">1x</span></p>
                
                <div class="prestige-icons" id="prestigeIcons">
                    <!-- Prestige icons will be generated -->
                </div>
                
                <button id="prestigeBtn" onclick="prestige()" disabled>PRESTIGE (Get 2x Multiplier)</button>
            </div>
        </div>

        <div class="tab-content" id="potionsTab">
            <div class="potions-section">
                <h2>üß™ POTION CHESTS üß™</h2>
                <p style="color: #ffd93d; text-align: center; margin-bottom: 15px;">Open chests to get boosts and Logan Modes!</p>
                
                <div class="chest-grid" id="chestsGrid">
                    <!-- Chests will be generated by JavaScript -->
                </div>
                
                <div class="inventory-section">
                    <h3>üß™ POTION INVENTORY üß™</h3>
                    <div class="inventory-grid" id="inventoryGrid">
                        <!-- Potion inventory items will be generated here -->
                    </div>
                </div>
                
                <div class="modes-section">
                    <h3>‚ö° MODES INVENTORY ‚ö°</h3>
                    <div class="modes-grid" id="modesGrid">
                        <!-- Mode inventory items will be generated here -->
                    </div>
                </div>
                
                <div class="boosts-section">
                    <h3>üöÄ ACTIVE BOOSTS üöÄ</h3>
                    <div class="active-boosts" id="activeBoosts">
                        <p style="text-align: center; color: #ffd93d; padding: 20px;">No active boosts</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mode-buttons-container" id="modeButtonsContainer">
        <!-- Mode buttons will be added here dynamically -->
    </div>

    <script>
        // ========== GAME STATE ==========
        // CHANGED SAVE KEY: brainrot_clicker_fresh_start_v2 - EVERYONE STARTS FRESH
        let brainrot = 0;
        let totalBrainrot = 0;
        let lifetimeBrainrot = 0;
        let totalClicks = 0;
        let prestigeLevel = 0;
        let prestigeMultiplier = 1;
        let loganModesLeft = 0;
        let buyableMultiplier = 1;
        let upgradeCheckInterval = null;
        
        // Active modes (temporary boosts)
        let loganActive = false;
        let loganTime = 0;
        let gangModeActive = false;
        let gangModeTime = 0;
        let untouchableModeActive = false;
        let untouchableModeTime = 0;
        let darkSupremeModeActive = false;
        let darkSupremeModeTime = 0;
        
        // Unlimited modes (permanent side buttons)
        let unlimitedGangMode = false;
        let unlimitedDarkSupremeMode = false;
        
        // Inventory system
        let potionInventory = {};
        let modesInventory = {
            'Logan Modes': 0,
            'Gang Modes': 0,
            'Untouchable Modes': 0,
            'Dark Supreme Modes': 0
        };
        
        // Active potion boosts
        let activeBoosts = {
            'Basic -IQ Potion': { multiplier: 1.25, timeLeft: 0 },
            'Medium -IQ Potion': { multiplier: 1.25, timeLeft: 0 },
            'Small Good -IQ Potion': { multiplier: 1.5, timeLeft: 0 },
            'Medium Good -IQ Potion': { multiplier: 1.5, timeLeft: 0 },
            'Large Good -IQ Potion': { multiplier: 1.5, timeLeft: 0 },
            'Small Great -IQ Potion': { multiplier: 1.75, timeLeft: 0 },
            'Medium Great -IQ Potion': { multiplier: 1.75, timeLeft: 0 },
            'Medium Super -IQ Potion': { multiplier: 2, timeLeft: 0 },
            'Isaac Potion': { multiplier: 2.5, timeLeft: 0 },
            'OP -IQ Potion': { multiplier: 5, timeLeft: 0 }
        };

        // Prestige icons
        const prestigeIcons = [
            { level: 0, emoji: "ü§™", name: "Newbie", color: "#ff6b6b", multiplier: 1 },
            { level: 1, emoji: "üß†", name: "2x Brainrot", color: "#4d96ff", multiplier: 2 },
            { level: 2, emoji: "üëÅÔ∏è", name: "4x Brainrot", color: "#9d4edd", multiplier: 4 },
            { level: 3, emoji: "üåÄ", name: "8x Brainrot", color: "#ffd93d", multiplier: 8 },
            { level: 4, emoji: "üåà", name: "16x Brainrot", color: "#6bcf7f", multiplier: 16 },
            { level: 5, emoji: "üëë", name: "32x Brainrot", color: "#ff6b6b", multiplier: 32 },
            { level: 6, emoji: "üåå", name: "64x Brainrot", color: "#9d4edd", multiplier: 64 },
            { level: 7, emoji: "‚ö°", name: "128x Brainrot", color: "#ffd93d", multiplier: 128 },
            { level: 8, emoji: "‚ôæÔ∏è", name: "256x Brainrot", color: "#4d96ff", multiplier: 256 },
            { level: 9, emoji: "ü¶Ö", name: "512x BRAINROT KING", color: "#6bcf7f", multiplier: 512 }
        ];

        // ========== CHEST DATA ==========
        const chests = [
            {
                id: 1,
                name: "Wood Chest",
                cost: 100000,
                color: "#8B4513",
                rewards: [
                    { chance: 90, name: "Basic -IQ Potion", multiplier: 1.25, duration: 300, type: "potion" },
                    { chance: 9, name: "Medium -IQ Potion", multiplier: 1.25, duration: 600, type: "potion" },
                    { chance: 1, name: "Small Good -IQ Potion", multiplier: 1.5, duration: 300, type: "potion" }
                ]
            },
            {
                id: 2,
                name: "Silver Chest",
                cost: 10000000,
                color: "#C0C0C0",
                rewards: [
                    { chance: 90, name: "Small Good -IQ Potion", multiplier: 1.5, duration: 300, type: "potion" },
                    { chance: 9, name: "Medium Good -IQ Potion", multiplier: 1.5, duration: 600, type: "potion" },
                    { chance: 1, name: "Large Good -IQ Potion", multiplier: 1.5, duration: 1800, type: "potion" }
                ]
            },
            {
                id: 3,
                name: "Gold Chest",
                cost: 1000000000,
                color: "#FFD700",
                rewards: [
                    { chance: 90, name: "Large Good -IQ Potion", multiplier: 1.5, duration: 1800, type: "potion" },
                    { chance: 9, name: "Small Great -IQ Potion", multiplier: 1.75, duration: 300, type: "potion" },
                    { chance: 1, name: "Medium Great -IQ Potion", multiplier: 1.75, duration: 600, type: "potion" }
                ]
            },
            {
                id: 4,
                name: "Diamond Chest",
                cost: 100000000000,
                color: "#4d96ff",
                rewards: [
                    { chance: 89, name: "Medium Great -IQ Potion", multiplier: 1.75, duration: 600, type: "potion" },
                    { chance: 9, name: "3x Logan Modes", type: "mode", amount: 3, modeType: "Logan Modes" },
                    { chance: 1.9, name: "10x Logan Modes", type: "mode", amount: 10, modeType: "Logan Modes" },
                    { chance: 0.1, name: "Medium Super -IQ Potion", multiplier: 2, duration: 600, type: "potion" }
                ]
            },
            {
                id: 5,
                name: "Supreme Chest",
                cost: 10000000000000,
                color: "#ff6b6b",
                rewards: [
                    { chance: 89, name: "10x Logan Modes", type: "mode", amount: 10, modeType: "Logan Modes" },
                    { chance: 9, name: "1x Gang Mode", type: "mode", amount: 1, modeType: "Gang Modes" },
                    { chance: 1.9, name: "Isaac Potion", multiplier: 2.5, duration: 300, type: "potion" },
                    { chance: 0.1, name: "5x Gang Mode", type: "mode", amount: 5, modeType: "Gang Modes" }
                ]
            },
            {
                id: 6,
                name: "Dark Supreme Chest",
                cost: 1000000000000000,
                color: "#9d4edd",
                rewards: [
                    { chance: 89, name: "3x Gang Mode", type: "mode", amount: 3, modeType: "Gang Modes" },
                    { chance: 8, name: "3x Isaac Potion", multiplier: 2.5, duration: 300, type: "potion", amount: 3 },
                    { chance: 1, name: "1x Untouchable Mode", type: "mode", amount: 1, modeType: "Untouchable Modes" },
                    { chance: 0.9, name: "Unlimited Gang Mode", type: "unlimited_gang" },
                    { chance: 0.5, name: "OP -IQ Potion", multiplier: 5, duration: 300, type: "potion" },
                    { chance: 0.5, name: "1x Dark Supreme Mode", type: "mode", amount: 1, modeType: "Dark Supreme Modes" },
                    { chance: 0.09, name: "10x OP -IQ Potion", multiplier: 5, duration: 300, type: "potion", amount: 10 },
                    { chance: 0.01, name: "Unlimited Dark Supreme Mode", type: "unlimited_dark_supreme" }
                ]
            }
        ];

        // ========== UPGRADES DATA ==========
        const upgrades = [
            { id: 1, name: "Extra Finger", desc: "+1 Brainrot per click", baseCost: 100, cost: 100, count: 0, power: 1, type: "click", unlockAt: 150, max: 50, multiplier: false },
            { id: 2, name: "Brain Cell", desc: "+2 Brainrot per second", baseCost: 500, cost: 500, count: 0, power: 2, type: "auto", unlockAt: 750, max: 40, multiplier: false },
            
            { id: 3, name: "2x Multiplier I", desc: "DOUBLES all Brainrot (resets on prestige)", baseCost: 2500, cost: 2500, count: 0, power: 2, type: "global", unlockAt: 3750, max: 1, multiplier: true },
            { id: 4, name: "Coffee Boost", desc: "+10 Brainrot per click", baseCost: 5000, cost: 5000, count: 0, power: 10, type: "click", unlockAt: 7500, max: 30, multiplier: false },
            
            { id: 5, name: "2x Multiplier II", desc: "DOUBLES all Brainrot (resets on prestige)", baseCost: 25000, cost: 25000, count: 0, power: 2, type: "global", unlockAt: 37500, max: 1, multiplier: true },
            { id: 6, name: "Brain Farm", desc: "+50 Brainrot per second", baseCost: 50000, cost: 50000, count: 0, power: 50, type: "auto", unlockAt: 75000, max: 20, multiplier: false },
            
            { id: 7, name: "2x Multiplier III", desc: "DOUBLES all Brainrot (resets on prestige)", baseCost: 250000, cost: 250000, count: 0, power: 2, type: "global", unlockAt: 375000, max: 1, multiplier: true },
            { id: 8, name: "Adderall", desc: "+100 Brainrot per click", baseCost: 500000, cost: 500000, count: 0, power: 100, type: "click", unlockAt: 750000, max: 15, multiplier: false },
            
            { id: 9, name: "2x Multiplier IV", desc: "DOUBLES all Brainrot (resets on prestige)", baseCost: 2500000, cost: 2500000, count: 0, power: 2, type: "global", unlockAt: 3750000, max: 1, multiplier: true },
            { id: 10, name: "Synapse Cluster", desc: "+500 Brainrot per second", baseCost: 5000000, cost: 5000000, count: 0, power: 500, type: "auto", unlockAt: 7500000, max: 10, multiplier: false },
            
            { id: 11, name: "2x Multiplier V", desc: "DOUBLES all Brainrot (resets on prestige)", baseCost: 25000000, cost: 25000000, count: 0, power: 2, type: "global", unlockAt: 37500000, max: 1, multiplier: true },
            { id: 12, name: "God Complex", desc: "+1,000 Brainrot per click", baseCost: 50000000, cost: 50000000, count: 0, power: 1000, type: "click", unlockAt: 75000000, max: 8, multiplier: false },
            
            { id: 13, name: "2x Multiplier VI", desc: "DOUBLES all Brainrot (resets on prestige)", baseCost: 250000000, cost: 250000000, count: 0, power: 2, type: "global", unlockAt: 375000000, max: 1, multiplier: true },
            { id: 14, name: "Neural Network", desc: "+5,000 Brainrot per second", baseCost: 500000000, cost: 500000000, count: 0, power: 5000, type: "auto", unlockAt: 750000000, max: 5, multiplier: false },
            
            { id: 15, name: "2x Multiplier VII", desc: "DOUBLES all Brainrot (resets on prestige)", baseCost: 2500000000, cost: 2500000000, count: 0, power: 2, type: "global", unlockAt: 3750000000, max: 1, multiplier: true },
            { id: 16, name: "Reality Warper", desc: "+10,000 Brainrot per click", baseCost: 5000000000, cost: 5000000000, count: 0, power: 10000, type: "click", unlockAt: 7500000000, max: 5, multiplier: false },
            
            { id: 17, name: "2x Multiplier VIII", desc: "DOUBLES all Brainrot (resets on prestige)", baseCost: 25000000000, cost: 25000000000, count: 0, power: 2, type: "global", unlockAt: 37500000000, max: 1, multiplier: true },
            { id: 18, name: "Brainrot Singularity", desc: "+50,000 Brainrot per second", baseCost: 50000000000, cost: 50000000000, count: 0, power: 50000, type: "auto", unlockAt: 75000000000, max: 3, multiplier: false },
            
            { id: 19, name: "2x Multiplier IX", desc: "DOUBLES all Brainrot (resets on prestige)", baseCost: 250000000000, cost: 250000000000, count: 0, power: 2, type: "global", unlockAt: 375000000000, max: 1, multiplier: true },
            { id: 20, name: "Omni-Click", desc: "+100,000 Brainrot per click", baseCost: 500000000000, cost: 500000000000, count: 0, power: 100000, type: "click", unlockAt: 750000000000, max: 3, multiplier: false },
            
            { id: 21, name: "2x Multiplier X", desc: "FINAL DOUBLE (resets on prestige)", baseCost: 1000000000000, cost: 1000000000000, count: 0, power: 2, type: "global", unlockAt: 1500000000000, max: 1, multiplier: true }
        ];

        // ========== TAB SYSTEM ==========
        function switchTab(tabName) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`${tabName}Tab`).classList.add('active');
            
            if (tabName === 'potions') {
                createChestElements();
                updateInventoryDisplay();
                updateActiveBoostsDisplay();
            }
        }

        // ========== INITIALIZATION ==========
        function init() {
            loadGame();
            updateMainIcon();
            createUpgradeElements();
            createPrestigeIcons();
            updateDisplay();
            updateModeButtons();
            gameLoop();
            
            upgradeCheckInterval = setInterval(createUpgradeElements, 1000);
        }

        // ========== MODE BUTTONS ON SIDE ==========
        function updateModeButtons() {
            const container = document.getElementById('modeButtonsContainer');
            container.innerHTML = '';
            
            // Logan Mode button (always shown if has uses)
            if (loganModesLeft > 0 || modesInventory['Logan Modes'] > 0) {
                const btn = document.createElement('button');
                btn.className = `mode-button logan-mode ${loganActive ? 'active' : ''}`;
                btn.textContent = `LOGAN MODE (${loganModesLeft} Left)`;
                btn.onclick = () => activateLoganMode();
                btn.disabled = loganActive || loganModesLeft <= 0;
                container.appendChild(btn);
            }
            
            // Gang Mode button (if unlimited or has active uses)
            if (unlimitedGangMode || gangModeActive || modesInventory['Gang Modes'] > 0) {
                const btn = document.createElement('button');
                btn.className = `mode-button gang-mode ${gangModeActive ? 'active' : ''}`;
                const uses = unlimitedGangMode ? '‚àû' : (modesInventory['Gang Modes'] > 0 ? modesInventory['Gang Modes'] : '0');
                btn.textContent = `GANG MODE (${uses} Left)`;
                btn.onclick = () => activateGangMode();
                btn.disabled = gangModeActive || (modesInventory['Gang Modes'] <= 0 && !unlimitedGangMode);
                container.appendChild(btn);
            }
            
            // Untouchable Mode button
            if (untouchableModeActive || modesInventory['Untouchable Modes'] > 0) {
                const btn = document.createElement('button');
                btn.className = `mode-button untouchable-mode ${untouchableModeActive ? 'active' : ''}`;
                btn.textContent = `UNTOUCHABLE MODE (${modesInventory['Untouchable Modes']} Left)`;
                btn.onclick = () => activateUntouchableMode();
                btn.disabled = untouchableModeActive || modesInventory['Untouchable Modes'] <= 0;
                container.appendChild(btn);
            }
            
            // Dark Supreme Mode button (if unlimited or has active uses)
            if (unlimitedDarkSupremeMode || darkSupremeModeActive || modesInventory['Dark Supreme Modes'] > 0) {
                const btn = document.createElement('button');
                btn.className = `mode-button dark-supreme-mode ${darkSupremeModeActive ? 'active' : ''}`;
                const uses = unlimitedDarkSupremeMode ? '‚àû' : (modesInventory['Dark Supreme Modes'] > 0 ? modesInventory['Dark Supreme Modes'] : '0');
                btn.textContent = `DARK SUPREME MODE (${uses} Left)`;
                btn.onclick = () => activateDarkSupremeMode();
                btn.disabled = darkSupremeModeActive || (modesInventory['Dark Supreme Modes'] <= 0 && !unlimitedDarkSupremeMode);
                container.appendChild(btn);
            }
        }

        // ========== MODE ACTIVATION FUNCTIONS ==========
        function activateLoganMode() {
            if (loganModesLeft > 0 && !loganActive) {
                loganModesLeft--;
                loganActive = true;
                loganTime = 300;
                showAchievement("LOGAN MODE ACTIVATED! 10x multiplier for 30 seconds!");
                updateModeButtons();
                updateDisplay();
                saveGame();
            }
        }

        function activateGangMode() {
            if (!gangModeActive) {
                if (unlimitedGangMode || modesInventory['Gang Modes'] > 0) {
                    if (!unlimitedGangMode) {
                        modesInventory['Gang Modes']--;
                    }
                    gangModeActive = true;
                    gangModeTime = 30;
                    showAchievement("GANG MODE ACTIVATED! 100x multiplier for 30 seconds!");
                    updateModeButtons();
                    updateInventoryDisplay();
                    updateActiveBoostsDisplay();
                    saveGame();
                }
            }
        }

        function activateUntouchableMode() {
            if (!untouchableModeActive && modesInventory['Untouchable Modes'] > 0) {
                modesInventory['Untouchable Modes']--;
                untouchableModeActive = true;
                untouchableModeTime = 30;
                showAchievement("UNTOUCHABLE MODE ACTIVATED! 300x multiplier for 30 seconds!");
                updateModeButtons();
                updateInventoryDisplay();
                updateActiveBoostsDisplay();
                saveGame();
            }
        }

        function activateDarkSupremeMode() {
            if (!darkSupremeModeActive) {
                if (unlimitedDarkSupremeMode || modesInventory['Dark Supreme Modes'] > 0) {
                    if (!unlimitedDarkSupremeMode) {
                        modesInventory['Dark Supreme Modes']--;
                    }
                    darkSupremeModeActive = true;
                    darkSupremeModeTime = 30;
                    showAchievement("DARK SUPREME MODE ACTIVATED! 500x multiplier for 30 seconds!");
                    updateModeButtons();
                    updateInventoryDisplay();
                    updateActiveBoostsDisplay();
                    saveGame();
                }
            }
        }

        // ========== CLICK FUNCTION ==========
        function clickBrainrot() {
            let clickPower = 1;
            
            upgrades.forEach(upgrade => {
                if (upgrade.type === "click" && upgrade.count > 0) {
                    clickPower += upgrade.power * upgrade.count;
                }
            });
            
            clickPower *= buyableMultiplier;
            clickPower *= prestigeMultiplier;
            
            // Apply active potion boosts (ADDITION)
            let potionBonus = 0;
            for (const boost in activeBoosts) {
                if (activeBoosts[boost].timeLeft > 0) {
                    potionBonus += (activeBoosts[boost].multiplier - 1);
                }
            }
            
            // Apply active modes (ADDITION)
            let modeBonus = 0;
            if (loganActive) modeBonus += 9; // 10x = +9
            if (gangModeActive) modeBonus += 99; // 100x = +99
            if (untouchableModeActive) modeBonus += 299; // 300x = +299
            if (darkSupremeModeActive) modeBonus += 499; // 500x = +499
            
            // Apply total bonus
            clickPower *= (1 + potionBonus + modeBonus);
            
            brainrot += clickPower;
            totalBrainrot += clickPower;
            lifetimeBrainrot += clickPower;
            totalClicks++;
            
            createClickEffect(clickPower);
            createParticles(3);
            checkAchievements();
            updateDisplay();
            saveGame();
        }

        // ========== VISUAL EFFECTS ==========
        function createClickEffect(amount) {
            const effects = document.getElementById('effects');
            const effect = document.createElement('div');
            effect.className = 'click-effect';
            effect.textContent = `+${formatNumber(amount)} üß†`;
            effect.style.left = `${50 + (Math.random() * 20 - 10)}%`;
            effect.style.top = `${50 + (Math.random() * 20 - 10)}%`;
            effect.style.color = getRandomColor();
            effects.appendChild(effect);
            setTimeout(() => effect.remove(), 1200);
        }

        function createParticles(count) {
            const effects = document.getElementById('effects');
            const icon = document.getElementById('mainIcon');
            const rect = icon.getBoundingClientRect();
            
            for (let i = 0; i < count; i++) {
                const particle = document.createElement('div');
                particle.className = 'brainrot-particle';
                particle.style.left = (rect.left + rect.width / 2) + 'px';
                particle.style.top = (rect.top + rect.height / 2) + 'px';
                particle.style.setProperty('--tx', (Math.random() * 200 - 100) + 'px');
                particle.style.setProperty('--ty', (Math.random() * 200 - 100) + 'px');
                particle.style.background = `linear-gradient(45deg, ${getRandomColor()}, ${getRandomColor()})`;
                effects.appendChild(particle);
                setTimeout(() => particle.remove(), 2500);
            }
        }

        function getRandomColor() {
            const colors = ['#ff6b6b', '#4d96ff', '#6bcf7f', '#ffd93d', '#9d4edd'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // ========== UPGRADES SYSTEM ==========
        function createUpgradeElements() {
            const grid = document.getElementById('upgradesGrid');
            grid.innerHTML = '';
            
            upgrades.forEach(upgrade => {
                const isUnlocked = lifetimeBrainrot >= (upgrade.baseCost * 1.5);
                const canAfford = brainrot >= upgrade.cost;
                const isMaxed = upgrade.count >= upgrade.max;
                const isBought = upgrade.count > 0;
                
                const item = document.createElement('div');
                item.className = `upgrade-item ${isUnlocked ? 'unlocked' : 'locked'} ${isBought ? 'bought' : ''}`;
                
                if (upgrade.multiplier) {
                    item.style.background = 'rgba(255, 215, 61, 0.1)';
                    item.style.border = '2px solid #ffd93d';
                }
                
                item.innerHTML = `
                    <div class="upgrade-name">${upgrade.name} ${isMaxed ? '‚úÖ' : ''}</div>
                    <div class="upgrade-desc">${upgrade.desc}</div>
                    <div class="upgrade-requirement">Unlocks at: ${formatNumber(upgrade.baseCost * 1.5)} Lifetime Brainrot</div>
                    <div class="upgrade-cost">Cost: ${formatNumber(upgrade.cost)} üß†</div>
                    <div class="upgrade-count">${upgrade.multiplier ? 'Resets on Prestige' : `Owned: ${upgrade.count}/${upgrade.max}`}</div>
                `;
                
                if (isUnlocked && !isMaxed && canAfford) {
                    item.onclick = () => buyUpgrade(upgrade.id);
                }
                
                grid.appendChild(item);
            });
        }

        function buyUpgrade(id) {
            const upgrade = upgrades.find(u => u.id === id);
            if (!upgrade) return;
            
            if (brainrot >= upgrade.cost && upgrade.count < upgrade.max) {
                brainrot -= upgrade.cost;
                upgrade.count++;
                
                if (upgrade.multiplier) {
                    buyableMultiplier *= 2;
                    showAchievement(`2X MULTIPLIER UNLOCKED!`);
                    createParticles(25);
                    
                    document.getElementById('mainIcon').style.animation = 'pulse 0.5s';
                    setTimeout(() => {
                        document.getElementById('mainIcon').style.animation = '';
                    }, 500);
                }
                
                if (!upgrade.multiplier) {
                    upgrade.cost = Math.floor(upgrade.cost * 2.5);
                }
                
                updateDisplay();
                createUpgradeElements();
                saveGame();
            }
        }

        // ========== CHEST SYSTEM ==========
        function createChestElements() {
            const grid = document.getElementById('chestsGrid');
            grid.innerHTML = '';
            
            chests.forEach(chest => {
                const canAfford = brainrot >= chest.cost;
                const item = document.createElement('div');
                item.className = `chest-item ${chest.name.toLowerCase().replace(' ', '-')} ${canAfford ? '' : 'disabled'}`;
                item.style.borderColor = chest.color;
                
                let oddsHTML = '';
                chest.rewards.forEach(reward => {
                    oddsHTML += `<div>${reward.chance}% - ${reward.name}</div>`;
                });
                
                item.innerHTML = `
                    <div class="chest-name" style="color: ${chest.color}">${chest.name}</div>
                    <div class="chest-cost">Cost: ${formatNumber(chest.cost)} üß†</div>
                    <div class="chest-odds">${oddsHTML}</div>
                `;
                
                if (canAfford) {
                    item.onclick = () => openChest(chest.id);
                }
                
                grid.appendChild(item);
            });
        }

        function openChest(chestId) {
            const chest = chests.find(c => c.id === chestId);
            if (!chest || brainrot < chest.cost) return;
            
            brainrot -= chest.cost;
            
            const random = Math.random() * 100;
            let cumulative = 0;
            let selectedReward = null;
            
            for (const reward of chest.rewards) {
                cumulative += reward.chance;
                if (random <= cumulative) {
                    selectedReward = reward;
                    break;
                }
            }
            
            if (!selectedReward) selectedReward = chest.rewards[0];
            
            addToInventory(selectedReward, chest.name);
            
            updateDisplay();
            createChestElements();
            updateInventoryDisplay();
            saveGame();
        }

        function addToInventory(reward, chestName) {
            let message = `You got ${reward.name} from ${chestName}!`;
            
            switch (reward.type) {
                case 'potion':
                    const amount = reward.amount || 1;
                    if (!potionInventory[reward.name]) {
                        potionInventory[reward.name] = 0;
                    }
                    potionInventory[reward.name] += amount;
                    if (amount > 1) {
                        message = `You got ${amount}x ${reward.name} from ${chestName}!`;
                    }
                    break;
                    
                case 'mode':
                    modesInventory[reward.modeType] += reward.amount;
                    message = `You got ${reward.amount} ${reward.modeType} from ${chestName}!`;
                    
                    if (reward.modeType === 'Logan Modes') {
                        loganModesLeft += reward.amount;
                    }
                    break;
                    
                case 'unlimited_gang':
                    unlimitedGangMode = true;
                    message = `UNLIMITED GANG MODE UNLOCKED from ${chestName}!`;
                    updateModeButtons();
                    break;
                    
                case 'unlimited_dark_supreme':
                    unlimitedDarkSupremeMode = true;
                    message = `UNLIMITED DARK SUPREME MODE UNLOCKED from ${chestName}!`;
                    updateModeButtons();
                    break;
            }
            
            showAchievement(message);
            createParticles(15);
        }

        // ========== INVENTORY SYSTEM ==========
        function updateInventoryDisplay() {
            const potionGrid = document.getElementById('inventoryGrid');
            potionGrid.innerHTML = '';
            
            let hasPotions = false;
            for (const potion in potionInventory) {
                if (potionInventory[potion] > 0) {
                    hasPotions = true;
                    addPotionItem(potionGrid, potion, potionInventory[potion], '#6bcf7f');
                }
            }
            
            if (!hasPotions) {
                potionGrid.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #ffd93d; padding: 20px;">No potions. Open chests to get potions!</p>';
            }
            
            const modesGrid = document.getElementById('modesGrid');
            modesGrid.innerHTML = '';
            
            let hasModes = false;
            const modeTypes = ['Logan Modes', 'Gang Modes', 'Untouchable Modes', 'Dark Supreme Modes'];
            
            modeTypes.forEach(modeType => {
                const count = modesInventory[modeType] || 0;
                if (count > 0) {
                    hasModes = true;
                    let color = '#ff6b6b';
                    if (modeType === 'Logan Modes') color = '#ff0000';
                    if (modeType === 'Gang Modes') color = '#ff6b6b';
                    if (modeType === 'Untouchable Modes') color = '#4d96ff';
                    if (modeType === 'Dark Supreme Modes') color = '#9d4edd';
                    
                    addModeItem(modesGrid, modeType, count, color);
                }
            });
            
            if (!hasModes) {
                modesGrid.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #ffd93d; padding: 20px;">No modes. Open chests to get modes!</p>';
            }
        }

        function addPotionItem(grid, name, count, color) {
            const item = document.createElement('div');
            item.className = 'inventory-item';
            item.style.borderColor = color;
            item.innerHTML = `
                <div class="inventory-item-name">${name}</div>
                <div class="inventory-item-count">${count}</div>
                <button class="inventory-item-use" onclick="usePotion('${name}')">Use</button>
            `;
            grid.appendChild(item);
        }

        function addModeItem(grid, name, count, color) {
            const item = document.createElement('div');
            item.className = 'inventory-item';
            item.style.borderColor = color;
            item.innerHTML = `
                <div class="inventory-item-name">${name}</div>
                <div class="inventory-item-count">${count}</div>
                <button class="inventory-item-use" onclick="useModeFromInventory('${name}')">${name === 'Logan Modes' ? 'Add to Uses' : 'Equip'}</button>
            `;
            grid.appendChild(item);
        }

        function usePotion(potionName) {
            if (potionInventory[potionName] > 0) {
                potionInventory[potionName]--;
                
                let potionData = null;
                for (const chest of chests) {
                    for (const reward of chest.rewards) {
                        if (reward.name === potionName && reward.type === 'potion') {
                            potionData = reward;
                            break;
                        }
                    }
                    if (potionData) break;
                }
                
                if (potionData) {
                    if (!activeBoosts[potionName]) {
                        activeBoosts[potionName] = { multiplier: potionData.multiplier, timeLeft: 0 };
                    }
                    activeBoosts[potionName].timeLeft += potionData.duration * 10;
                    
                    showAchievement(`Used ${potionName}! Added ${potionData.duration/60} minutes to boost!`);
                    updateInventoryDisplay();
                    updateActiveBoostsDisplay();
                    saveGame();
                }
            }
        }

        function useModeFromInventory(modeName) {
            if (modesInventory[modeName] > 0) {
                modesInventory[modeName]--;
                
                if (modeName === 'Logan Modes') {
                    loganModesLeft++;
                    showAchievement("Added 1 Logan Mode to your available uses!");
                } else {
                    showAchievement(`Equipped 1 ${modeName}! Check the side buttons to activate it!`);
                }
                
                updateModeButtons();
                updateInventoryDisplay();
                saveGame();
            }
        }

        function updateActiveBoostsDisplay() {
            const container = document.getElementById('activeBoosts');
            let hasActiveBoosts = false;
            
            for (const boost in activeBoosts) {
                if (activeBoosts[boost].timeLeft > 0) {
                    hasActiveBoosts = true;
                    break;
                }
            }
            
            if (!hasActiveBoosts && !gangModeActive && !untouchableModeActive && !darkSupremeModeActive && !loganActive) {
                container.innerHTML = '<p style="text-align: center; color: #ffd93d; padding: 20px;">No active boosts</p>';
                return;
            }
            
            container.innerHTML = '';
            
            for (const boost in activeBoosts) {
                if (activeBoosts[boost].timeLeft > 0) {
                    const minutes = Math.floor(activeBoosts[boost].timeLeft / 600);
                    const seconds = Math.floor((activeBoosts[boost].timeLeft % 600) / 10);
                    const item = document.createElement('div');
                    item.className = 'boost-item';
                    item.style.borderLeftColor = '#6bcf7f';
                    item.innerHTML = `
                        <div>
                            <strong>${boost}</strong><br>
                            <small>${activeBoosts[boost].multiplier}x Multiplier</small>
                        </div>
                        <div class="boost-timer">${minutes}:${seconds.toString().padStart(2, '0')}</div>
                    `;
                    container.appendChild(item);
                }
            }
            
            if (loganActive) {
                const item = document.createElement('div');
                item.className = 'boost-item';
                item.style.borderLeftColor = '#ff0000';
                item.innerHTML = `
                    <div>
                        <strong>LOGAN MODE</strong><br>
                        <small>10x Multiplier</small>
                    </div>
                    <div class="boost-timer">${Math.floor(loganTime/10)}s</div>
                `;
                container.appendChild(item);
            }
            
            if (gangModeActive) {
                const item = document.createElement('div');
                item.className = 'boost-item';
                item.style.borderLeftColor = '#ff6b6b';
                item.innerHTML = `
                    <div>
                        <strong>GANG MODE</strong><br>
                        <small>100x Multiplier</small>
                    </div>
                    <div class="boost-timer">${gangModeTime}s</div>
                `;
                container.appendChild(item);
            }
            
            if (untouchableModeActive) {
                const item = document.createElement('div');
                item.className = 'boost-item';
                item.style.borderLeftColor = '#4d96ff';
                item.innerHTML = `
                    <div>
                        <strong>UNTOUCHABLE MODE</strong><br>
                        <small>300x Multiplier</small>
                    </div>
                    <div class="boost-timer">${untouchableModeTime}s</div>
                `;
                container.appendChild(item);
            }
            
            if (darkSupremeModeActive) {
                const item = document.createElement('div');
                item.className = 'boost-item';
                item.style.borderLeftColor = '#9d4edd';
                item.innerHTML = `
                    <div>
                        <strong>DARK SUPREME MODE</strong><br>
                        <small>500x Multiplier</small>
                    </div>
                    <div class="boost-timer">${darkSupremeModeTime}s</div>
                `;
                container.appendChild(item);
            }
        }

        // ========== PRODUCTION CALCULATION ==========
        function calculateBPS() {
            let bps = 0;
            
            upgrades.forEach(upgrade => {
                if (upgrade.type === "auto" && upgrade.count > 0) {
                    bps += upgrade.power * upgrade.count;
                }
            });
            
            bps *= buyableMultiplier;
            bps *= prestigeMultiplier;
            
            let potionBonus = 0;
            for (const boost in activeBoosts) {
                if (activeBoosts[boost].timeLeft > 0) {
                    potionBonus += (activeBoosts[boost].multiplier - 1);
                }
            }
            
            let modeBonus = 0;
            if (loganActive) modeBonus += 9;
            if (gangModeActive) modeBonus += 99;
            if (untouchableModeActive) modeBonus += 299;
            if (darkSupremeModeActive) modeBonus += 499;
            
            bps *= (1 + potionBonus + modeBonus);
            
            return bps;
        }

        function calculateClickPower() {
            let power = 1;
            
            upgrades.forEach(upgrade => {
                if (upgrade.type === "click" && upgrade.count > 0) {
                    power += upgrade.power * upgrade.count;
                }
            });
            
            power *= buyableMultiplier;
            power *= prestigeMultiplier;
            
            let potionBonus = 0;
            for (const boost in activeBoosts) {
                if (activeBoosts[boost].timeLeft > 0) {
                    potionBonus += (activeBoosts[boost].multiplier - 1);
                }
            }
            
            let modeBonus = 0;
            if (loganActive) modeBonus += 9;
            if (gangModeActive) modeBonus += 99;
            if (untouchableModeActive) modeBonus += 299;
            if (darkSupremeModeActive) modeBonus += 499;
            
            power *= (1 + potionBonus + modeBonus);
            
            return power;
        }

        function calculateTotalMultiplier() {
            let total = buyableMultiplier * prestigeMultiplier;
            
            let potionBonus = 0;
            for (const boost in activeBoosts) {
                if (activeBoosts[boost].timeLeft > 0) {
                    potionBonus += (activeBoosts[boost].multiplier - 1);
                }
            }
            
            let modeBonus = 0;
            if (loganActive) modeBonus += 9;
            if (gangModeActive) modeBonus += 99;
            if (untouchableModeActive) modeBonus += 299;
            if (darkSupremeModeActive) modeBonus += 499;
            
            total *= (1 + potionBonus + modeBonus);
            
            return total;
        }

        // ========== GAME LOOP ==========
        function gameLoop() {
            const bps = calculateBPS();
            if (bps > 0) {
                const gain = bps / 10;
                brainrot += gain;
                totalBrainrot += gain;
                lifetimeBrainrot += gain;
            }
            
            // Update timers
            if (loganActive) {
                loganTime--;
                if (loganTime <= 0) {
                    loganActive = false;
                    updateModeButtons();
                }
            }
            
            if (gangModeActive) {
                gangModeTime--;
                if (gangModeTime <= 0) {
                    gangModeActive = false;
                    updateModeButtons();
                    updateActiveBoostsDisplay();
                }
            }
            
            if (untouchableModeActive) {
                untouchableModeTime--;
                if (untouchableModeTime <= 0) {
                    untouchableModeActive = false;
                    updateModeButtons();
                    updateActiveBoostsDisplay();
                }
            }
            
            if (darkSupremeModeActive) {
                darkSupremeModeTime--;
                if (darkSupremeModeTime <= 0) {
                    darkSupremeModeActive = false;
                    updateModeButtons();
                    updateActiveBoostsDisplay();
                }
            }
            
            let needsBoostUpdate = false;
            for (const boost in activeBoosts) {
                if (activeBoosts[boost].timeLeft > 0) {
                    activeBoosts[boost].timeLeft--;
                    needsBoostUpdate = true;
                }
            }
            if (needsBoostUpdate) {
                updateActiveBoostsDisplay();
            }
            
            const required = 1000000 * Math.pow(10, prestigeLevel);
            const prestigeBtn = document.getElementById('prestigeBtn');
            
            if (brainrot >= required && prestigeLevel < 9) {
                prestigeBtn.disabled = false;
                const nextMultiplier = Math.pow(2, prestigeLevel + 1);
                prestigeBtn.textContent = `PRESTIGE (Get ${nextMultiplier}x Multiplier)`;
                prestigeBtn.style.background = `linear-gradient(45deg, #6bcf7f, #4d96ff)`;
            } else if (prestigeLevel >= 9) {
                prestigeBtn.disabled = true;
                prestigeBtn.textContent = `MAX PRESTIGE REACHED!`;
                prestigeBtn.style.background = `linear-gradient(45deg, #ffd93d, #ff6b6b)`;
            } else {
                prestigeBtn.disabled = true;
                prestigeBtn.style.background = `linear-gradient(45deg, #9d4edd, #ff6b6b)`;
            }
            
            const fillPercent = Math.min((brainrot / required) * 100, 100);
            document.getElementById('brainrotFill').style.width = `${fillPercent}%`;
            
            updateDisplay();
            setTimeout(gameLoop, 100);
        }

        // ========== PRESTIGE SYSTEM ==========
        function createPrestigeIcons() {
            const container = document.getElementById('prestigeIcons');
            container.innerHTML = '';
            
            const maxPrestiges = 9;
            prestigeIcons.forEach((icon, index) => {
                if (index <= maxPrestiges) {
                    const iconEl = document.createElement('div');
                    iconEl.className = `prestige-icon ${index <= prestigeLevel ? 'active' : ''}`;
                    iconEl.textContent = icon.emoji;
                    iconEl.style.color = icon.color;
                    iconEl.title = `${icon.name} (${icon.multiplier}x)`;
                    container.appendChild(iconEl);
                }
            });
        }

        function updateMainIcon() {
            const icon = document.getElementById('mainIcon');
            const currentIcon = prestigeIcons[Math.min(prestigeLevel, prestigeIcons.length - 1)];
            
            icon.innerHTML = currentIcon.emoji;
            icon.style.background = `linear-gradient(45deg, ${currentIcon.color}, ${getRandomColor()})`;
            icon.style.boxShadow = `0 0 60px ${currentIcon.color}80`;
            
            document.getElementById('currentMultiplier').textContent = `${currentIcon.multiplier}x`;
            document.getElementById('currentMultiplier').style.color = currentIcon.color;
        }

        function prestige() {
            const required = 1000000 * Math.pow(10, prestigeLevel);
            
            if (brainrot >= required && prestigeLevel < 9) {
                prestigeLevel++;
                prestigeMultiplier = Math.pow(2, prestigeLevel);
                
                brainrot = 0;
                totalBrainrot = 0;
                totalClicks = 0;
                buyableMultiplier = 1;
                
                // Keep inventory, modes, and unlimited modes on prestige
                // Only reset upgrades
                upgrades.forEach(upgrade => {
                    upgrade.count = 0;
                    upgrade.cost = upgrade.baseCost;
                });
                
                updateMainIcon();
                createPrestigeIcons();
                
                showAchievement(`PRESTIGE ${prestigeLevel}! Got ${prestigeMultiplier}x Multiplier!`);
                createParticles(50);
                
                updateDisplay();
                createUpgradeElements();
                updateInventoryDisplay();
                saveGame();
            }
        }

        // ========== RESET GAME DATA ==========
        function resetGameData() {
            if (confirm("Are you sure you want to reset ALL game data? This cannot be undone!")) {
                localStorage.removeItem('brainrot_clicker_fresh_start_v2');
                location.reload();
            }
        }

        // ========== ACHIEVEMENTS ==========
        function checkAchievements() {
            const achievements = [
                { check: () => lifetimeBrainrot >= 1000, text: "1K Lifetime Brainrot!" },
                { check: () => lifetimeBrainrot >= 10000, text: "10K Lifetime Brainrot!!" },
                { check: () => lifetimeBrainrot >= 100000, text: "100K Lifetime Brainrot!!!" },
                { check: () => totalClicks >= 100, text: "100 Clicks!" },
                { check: () => upgrades.some(u => u.multiplier && u.count > 0), text: "First 2x Multiplier!" }
            ];
            
            achievements.forEach(achievement => {
                if (achievement.check() && !localStorage.getItem(`achievement_${achievement.text}`)) {
                    showAchievement(achievement.text);
                    localStorage.setItem(`achievement_${achievement.text}`, 'true');
                }
            });
        }

        function showAchievement(text) {
            const popup = document.createElement('div');
            popup.className = 'achievement-popup';
            popup.textContent = `üèÜ ${text}`;
            document.body.appendChild(popup);
            setTimeout(() => popup.remove(), 3000);
        }

        // ========== DISPLAY UPDATE ==========
        function updateDisplay() {
            document.getElementById('currentBrainrot').textContent = formatNumber(brainrot);
            document.getElementById('totalBrainrot').textContent = formatNumber(totalBrainrot);
            document.getElementById('lifetimeBrainrot').textContent = formatNumber(lifetimeBrainrot);
            document.getElementById('totalClicks').textContent = formatNumber(totalClicks);
            document.getElementById('prestigeLevel').textContent = prestigeLevel;
            document.getElementById('clickPower').textContent = formatNumber(calculateClickPower());
            document.getElementById('bps').textContent = formatNumber(calculateBPS());
            
            document.getElementById('buyableMultiplier').textContent = formatNumber(buyableMultiplier) + 'x';
            document.getElementById('prestigeMultiplierDisplay').textContent = formatNumber(prestigeMultiplier) + 'x';
            
            const totalEffectiveMultiplier = calculateTotalMultiplier();
            document.getElementById('totalMultiplier').textContent = formatNumber(totalEffectiveMultiplier) + 'x';
            
            document.getElementById('prestigeRequirement').textContent = formatNumber(1000000 * Math.pow(10, prestigeLevel));
        }

        // ========== UTILITIES ==========
        function formatNumber(num) {
            if (num >= 1e15) return (num / 1e15).toFixed(3) + 'Qd';
            if (num >= 1e12) return (num / 1e12).toFixed(3) + 'T';
            if (num >= 1e9) return (num / 1e9).toFixed(3) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(3) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';
            return Math.floor(num);
        }

        // ========== SAVE/LOAD ==========
        // CHANGED SAVE KEY: brainrot_clicker_fresh_start_v2
        function saveGame() {
            const saveData = {
                brainrot,
                totalBrainrot,
                lifetimeBrainrot,
                totalClicks,
                prestigeLevel,
                prestigeMultiplier,
                buyableMultiplier,
                loganModesLeft,
                unlimitedGangMode,
                unlimitedDarkSupremeMode,
                potionInventory,
                modesInventory,
                activeBoosts,
                upgrades: upgrades.map(u => ({ id: u.id, count: u.count, cost: u.cost }))
            };
            localStorage.setItem('brainrot_clicker_fresh_start_v2', JSON.stringify(saveData));
        }

        function loadGame() {
            const saved = localStorage.getItem('brainrot_clicker_fresh_start_v2');
            if (saved) {
                const saveData = JSON.parse(saved);
                brainrot = saveData.brainrot || 0;
                totalBrainrot = saveData.totalBrainrot || 0;
                lifetimeBrainrot = saveData.lifetimeBrainrot || 0;
                totalClicks = saveData.totalClicks || 0;
                prestigeLevel = saveData.prestigeLevel || 0;
                prestigeMultiplier = saveData.prestigeMultiplier || 1;
                buyableMultiplier = saveData.buyableMultiplier || 1;
                loganModesLeft = saveData.loganModesLeft || 0;
                unlimitedGangMode = saveData.unlimitedGangMode || false;
                unlimitedDarkSupremeMode = saveData.unlimitedDarkSupremeMode || false;
                potionInventory = saveData.potionInventory || {};
                modesInventory = saveData.modesInventory || {
                    'Logan Modes': 0,
                    'Gang Modes': 0,
                    'Untouchable Modes': 0,
                    'Dark Supreme Modes': 0
                };
                activeBoosts = saveData.activeBoosts || {
                    'Basic -IQ Potion': { multiplier: 1.25, timeLeft: 0 },
                    'Medium -IQ Potion': { multiplier: 1.25, timeLeft: 0 },
                    'Small Good -IQ Potion': { multiplier: 1.5, timeLeft: 0 },
                    'Medium Good -IQ Potion': { multiplier: 1.5, timeLeft: 0 },
                    'Large Good -IQ Potion': { multiplier: 1.5, timeLeft: 0 },
                    'Small Great -IQ Potion': { multiplier: 1.75, timeLeft: 0 },
                    'Medium Great -IQ Potion': { multiplier: 1.75, timeLeft: 0 },
                    'Medium Super -IQ Potion': { multiplier: 2, timeLeft: 0 },
                    'Isaac Potion': { multiplier: 2.5, timeLeft: 0 },
                    'OP -IQ Potion': { multiplier: 5, timeLeft: 0 }
                };
                
                if (saveData.upgrades) {
                    saveData.upgrades.forEach(savedUpgrade => {
                        const upgrade = upgrades.find(u => u.id === savedUpgrade.id);
                        if (upgrade) {
                            upgrade.count = savedUpgrade.count || 0;
                            upgrade.cost = savedUpgrade.cost || upgrade.baseCost;
                        }
                    });
                }
            }
        }

        // ========== START GAME ==========
        window.onload = init;

        // Add animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes titleGlow {
                0% { filter: hue-rotate(0deg) drop-shadow(0 0 20px #ff6b6b); }
                25% { filter: hue-rotate(90deg) drop-shadow(0 0 20px #4d96ff); }
                50% { filter: hue-rotate(180deg) drop-shadow(0 0 20px #6bcf7f); }
                75% { filter: hue-rotate(270deg) drop-shadow(0 0 20px #ffd93d); }
                100% { filter: hue-rotate(360deg) drop-shadow(0 0 20px #9d4edd); }
            }
            
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
            }
            
            #mainIcon {
                transition: transform 0.3s, background 0.5s;
            }
            
            #mainIcon:hover {
                transform: scale(1.05);
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>