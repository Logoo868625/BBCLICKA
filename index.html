<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brainrot Clicker - Logan Beggs Edition</title>
    <style>
        /* [ALL THE SAME CSS STYLES AS BEFORE - KEEP ALL OF IT] */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: white;
            font-family: 'Comic Sans MS', 'Arial Rounded MT Bold', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .tab-navigation {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .tab-btn {
            background: linear-gradient(45deg, #9d4edd, #ff6b6b);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.5em;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(157, 78, 221, 0.4);
        }

        .tab-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(157, 78, 221, 0.6);
        }

        .tab-btn.active {
            background: linear-gradient(45deg, #4d96ff, #6bcf7f);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(77, 150, 255, 0.6);
        }

        .content-section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        header {
            text-align: center;
            padding: 20px 0;
            background: rgba(255, 107, 107, 0.2);
            border-radius: 20px;
            margin-bottom: 25px;
            border: 4px solid #ff6b6b;
            box-shadow: 0 0 40px rgba(255, 107, 107, 0.4);
            position: relative;
            overflow: hidden;
        }

        h1 {
            font-size: 4em;
            background: linear-gradient(45deg, #ff6b6b, #ffd93d, #6bcf7f);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 30px rgba(255, 107, 107, 0.5);
            margin-bottom: 5px;
            animation: titleGlow 3s infinite alternate;
        }

        @keyframes titleGlow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        .creator {
            font-size: 1.2em;
            color: #6bcf7f;
            font-style: italic;
            margin-bottom: 10px;
        }

        .tagline {
            font-size: 1.3em;
            color: #ffd93d;
            font-weight: bold;
        }

        .game-area {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            margin-bottom: 25px;
        }

        .clicker-section {
            flex: 1;
            min-width: 350px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 25px;
            padding: 25px;
            border: 3px solid #4d96ff;
            box-shadow: 0 0 25px rgba(77, 150, 255, 0.4);
        }

        .brainrot-display {
            width: 350px;
            height: 350px;
            margin: 0 auto 25px;
            position: relative;
        }

        #mainIcon {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff6b6b, #4d96ff);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8em;
            cursor: pointer;
            user-select: none;
            transition: transform 0.1s, filter 0.3s;
            border: 15px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 60px rgba(255, 107, 107, 0.6);
        }

        #mainIcon:active {
            transform: scale(0.92);
        }

        .stats-section {
            flex: 1;
            min-width: 350px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 25px;
            padding: 25px;
            border: 3px solid #6bcf7f;
            box-shadow: 0 0 25px rgba(107, 207, 127, 0.4);
        }

        .stat {
            display: flex;
            justify-content: space-between;
            margin: 12px 0;
            padding: 12px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            transition: background 0.3s;
        }

        .stat:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #ffd93d;
        }

        .shop-section {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 25px;
            padding: 25px;
            border: 3px solid #9d4edd;
            box-shadow: 0 0 25px rgba(157, 78, 221, 0.4);
            margin-bottom: 25px;
        }

        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .upgrade-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            opacity: 0.5;
            position: relative;
        }

        .upgrade-item.unlocked {
            opacity: 1;
            cursor: pointer;
        }

        .upgrade-item.locked::before {
            content: "üîí";
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.5em;
        }

        .upgrade-item.unlocked:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ff6b6b;
            transform: translateY(-8px);
        }

        .upgrade-item.bought {
            background: rgba(107, 207, 127, 0.2);
            border-color: #6bcf7f;
        }

        .upgrade-name {
            font-size: 1.5em;
            color: #4d96ff;
            margin-bottom: 8px;
        }

        .upgrade-desc {
            color: #ffd93d;
            margin-bottom: 10px;
            font-size: 0.95em;
            min-height: 40px;
        }

        .upgrade-cost {
            color: #ff6b6b;
            font-weight: bold;
            font-size: 1.3em;
            margin-bottom: 8px;
        }

        .upgrade-requirement {
            color: #9d4edd;
            font-size: 0.9em;
            margin-bottom: 8px;
        }

        .upgrade-count {
            color: #6bcf7f;
            font-weight: bold;
            margin-top: 8px;
            font-size: 1.1em;
        }

        .effects-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .click-effect {
            position: absolute;
            font-size: 2.2em;
            font-weight: bold;
            animation: floatUp 1.2s forwards;
            pointer-events: none;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(1) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(-120px) scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        .brainrot-particle {
            position: absolute;
            width: 24px;
            height: 24px;
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            border-radius: 50%;
            animation: particleFloat 2.5s forwards;
            pointer-events: none;
        }

        @keyframes particleFloat {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }

        .prestige-section {
            text-align: center;
            margin-top: 25px;
            padding: 25px;
            background: linear-gradient(135deg, rgba(157, 78, 221, 0.3), rgba(255, 215, 61, 0.3));
            border-radius: 20px;
            border: 3px solid #9d4edd;
        }

        #prestigeBtn {
            background: linear-gradient(45deg, #9d4edd, #ff6b6b);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 1.5em;
            border-radius: 60px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 15px;
            box-shadow: 0 10px 25px rgba(157, 78, 221, 0.4);
        }

        #prestigeBtn:hover:not(:disabled) {
            transform: scale(1.12);
            box-shadow: 0 15px 35px rgba(157, 78, 221, 0.6);
        }

        #prestigeBtn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .prestige-icon-info {
            margin-top: 15px;
            color: #ffd93d;
            font-size: 1.1em;
        }

        .prestige-icons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .prestige-icon {
            font-size: 2.5em;
            opacity: 0.3;
            transition: opacity 0.3s;
        }

        .prestige-icon.active {
            opacity: 1;
            transform: scale(1.2);
            filter: drop-shadow(0 0 10px currentColor);
        }

        .logan-mode {
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 1001;
        }

        #loganBtn {
            background: linear-gradient(45deg, #ff0000, #ffff00, #00ff00);
            color: black;
            border: none;
            padding: 15px 30px;
            font-size: 1.3em;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            animation: loganPulse 2s infinite;
        }

        @keyframes loganPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        #loganBtn:hover {
            animation: none;
            transform: scale(1.1) rotate(5deg);
        }

        .achievement-popup {
            position: fixed;
            top: 25px;
            right: 25px;
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            color: black;
            padding: 18px;
            border-radius: 15px;
            animation: slideIn 0.5s, slideOut 0.5s 3s forwards;
            font-weight: bold;
            z-index: 1002;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .brainrot-meter {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
        }

        .brainrot-fill {
            height: 100%;
            background: linear-gradient(90deg, #4d96ff, #9d4edd);
            border-radius: 10px;
            transition: width 0.5s;
            position: relative;
            overflow: hidden;
        }

        .brainrot-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* LEADERBOARD STYLES */
        .leaderboard-section {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 25px;
            padding: 25px;
            border: 3px solid #ffd93d;
            box-shadow: 0 0 25px rgba(255, 215, 61, 0.4);
            margin-bottom: 25px;
        }

        .leaderboard-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .leaderboard-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .leaderboard-header h2 {
            font-size: 2.5em;
            color: #ffd93d;
            margin-bottom: 10px;
            text-shadow: 0 0 15px rgba(255, 215, 61, 0.5);
        }

        .leaderboard-subtitle {
            color: #4d96ff;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .leaderboard-table th {
            background: linear-gradient(45deg, #9d4edd, #4d96ff);
            padding: 15px;
            text-align: left;
            font-size: 1.2em;
            border-bottom: 3px solid #ffd93d;
        }

        .leaderboard-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 1.1em;
        }

        .leaderboard-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .leaderboard-table tr:nth-child(1) {
            background: rgba(255, 215, 61, 0.1);
            color: #ffd93d;
            font-weight: bold;
        }

        .leaderboard-table tr:nth-child(2) {
            background: rgba(192, 192, 192, 0.1);
            color: #c0c0c0;
        }

        .leaderboard-table tr:nth-child(3) {
            background: rgba(205, 127, 50, 0.1);
            color: #cd7f32;
        }

        .rank-badge {
            display: inline-block;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: bold;
            margin-right: 10px;
        }

        .rank-1 .rank-badge {
            background: linear-gradient(45deg, #ffd93d, #ff6b6b);
            color: black;
        }

        .rank-2 .rank-badge {
            background: linear-gradient(45deg, #c0c0c0, #9d9d9d);
            color: black;
        }

        .rank-3 .rank-badge {
            background: linear-gradient(45deg, #cd7f32, #a0522d);
            color: black;
        }

        .rank-4-10 .rank-badge {
            background: linear-gradient(45deg, #4d96ff, #6bcf7f);
            color: white;
        }

        .player-name {
            font-weight: bold;
        }

        .player-score {
            color: #ff6b6b;
            font-weight: bold;
            font-size: 1.2em;
        }

        .player-prestige {
            color: #9d4edd;
            font-weight: bold;
        }

        .leaderboard-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            margin-bottom: 20px;
        }

        .leaderboard-btn {
            background: linear-gradient(45deg, #4d96ff, #9d4edd);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .leaderboard-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(77, 150, 255, 0.4);
        }

        .leaderboard-stats {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
        }

        .your-rank {
            font-size: 1.3em;
            color: #ffd93d;
            margin-bottom: 10px;
        }

        .total-players {
            color: #6bcf7f;
            font-size: 1.1em;
        }

        .refresh-info {
            color: #4d96ff;
            font-size: 0.9em;
            margin-top: 20px;
            font-style: italic;
        }

        .empty-leaderboard {
            text-align: center;
            padding: 50px;
            color: #ffd93d;
            font-size: 1.2em;
        }

        .empty-leaderboard .emoji {
            font-size: 4em;
            margin-bottom: 20px;
            display: block;
        }

        /* SIMPLE LOGIN */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .login-box {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            padding: 40px;
            border-radius: 25px;
            width: 90%;
            max-width: 500px;
            border: 3px solid #ff6b6b;
            box-shadow: 0 0 50px rgba(255, 107, 107, 0.5);
            text-align: center;
        }

        .login-box h2 {
            color: #ffd93d;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .login-input {
            width: 100%;
            padding: 15px;
            margin: 15px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #4d96ff;
            border-radius: 10px;
            color: white;
            font-size: 1.1em;
        }

        .login-input:focus {
            outline: none;
            border-color: #ff6b6b;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #4d96ff, #6bcf7f);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .login-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(77, 150, 255, 0.4);
        }

        .player-info {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 20px;
            border: 2px solid #6bcf7f;
            z-index: 100;
            font-size: 0.9em;
        }

        .player-info span {
            color: #ffd93d;
            font-weight: bold;
        }

        /* API STATUS */
        .api-status {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        .status-online {
            background: #6bcf7f;
            box-shadow: 0 0 10px #6bcf7f;
        }

        .status-offline {
            background: #ff6b6b;
            box-shadow: 0 0 10px #ff6b6b;
        }

        @media (max-width: 900px) {
            .game-area {
                flex-direction: column;
            }
            
            .brainrot-display {
                width: 280px;
                height: 280px;
            }
            
            h1 {
                font-size: 2.8em;
            }
            
            #mainIcon {
                font-size: 6em;
            }
            
            .tab-btn {
                padding: 12px 25px;
                font-size: 1.2em;
            }
            
            .leaderboard-table th,
            .leaderboard-table td {
                padding: 10px;
                font-size: 1em;
            }
            
            .player-info, .api-status {
                position: relative;
                top: 0;
                margin: 10px auto;
                width: fit-content;
            }
        }

        @media (max-width: 600px) {
            .shop-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 15px;
            }
            
            .tab-navigation {
                flex-direction: column;
                align-items: center;
            }
            
            .tab-btn {
                width: 200px;
            }
            
            .leaderboard-table {
                font-size: 0.9em;
            }
            
            .leaderboard-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .login-box {
                padding: 20px;
                margin: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="effects-container" id="effects"></div>

    <!-- API Status -->
    <div class="api-status" id="apiStatus" style="display: none;">
        <span class="status-dot status-offline" id="statusDot"></span>
        <span id="statusText">Connecting...</span>
    </div>

    <!-- Simple Login -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-box">
            <h2>üß† BRAINROT CLICKER üß†</h2>
            <p style="color: #4d96ff; margin-bottom: 30px;">Enter your name to start playing!</p>
            
            <input type="text" id="playerNameInput" class="login-input" placeholder="Enter your name" maxlength="20" autocomplete="off">
            
            <button class="login-btn" onclick="startGame()">üéÆ START PLAYING</button>
            
            <div style="margin-top: 20px; color: #ffd93d; font-size: 0.9em;">
                <p>‚úÖ REAL Global Leaderboard</p>
                <p>‚úÖ Works across all devices</p>
                <p>‚úÖ Auto-saves progress</p>
            </div>
        </div>
    </div>

    <!-- Player Info -->
    <div class="player-info" id="playerInfo" style="display: none;">
        Playing as: <span id="playerNameDisplay"></span>
    </div>

    <div class="container" id="gameContainer" style="display: none;">
        <!-- TAB NAVIGATION -->
        <div class="tab-navigation">
            <button class="tab-btn active" onclick="switchTab('game')">üéÆ GAME</button>
            <button class="tab-btn" onclick="switchTab('leaderboard')">üèÜ LEADERBOARD</button>
        </div>

        <!-- GAME SECTION -->
        <div id="gameSection" class="content-section active">
            <header>
                <h1>üß† BRAINROT CLICKER üß†</h1>
                <div class="creator">Made by Logan Beggs</div>
                <p class="tagline">Click to rot your brain. Prestige to transcend.</p>
                
                <div class="brainrot-meter">
                    <div class="brainrot-fill" id="brainrotFill" style="width: 0%"></div>
                </div>
            </header>

            <div class="game-area">
                <div class="clicker-section">
                    <h2>üß† CLICK THE BRAINROT üß†</h2>
                    <div class="brainrot-display">
                        <div id="mainIcon" onclick="clickBrainrot()">
                            ü§™
                        </div>
                    </div>
                    <div class="stats">
                        <div class="stat">
                            <span>Brainrot Per Click:</span>
                            <span class="stat-value" id="clickPower">1</span>
                        </div>
                        <div class="stat">
                            <span>Brainrot Per Second:</span>
                            <span class="stat-value" id="bps">0</span>
                        </div>
                    </div>
                </div>

                <div class="stats-section">
                    <h2>üìä BRAINROT STATS üìä</h2>
                    <div class="stat">
                        <span>Current Brainrot:</span>
                        <span class="stat-value" id="currentBrainrot">0</span>
                    </div>
                    <div class="stat">
                        <span>Total Brainrot:</span>
                        <span class="stat-value" id="totalBrainrot">0</span>
                    </div>
                    <div class="stat">
                        <span>Lifetime Brainrot:</span>
                        <span class="stat-value" id="lifetimeBrainrot">0</span>
                    </div>
                    <div class="stat">
                        <span>Clicks Made:</span>
                        <span class="stat-value" id="totalClicks">0</span>
                    </div>
                    <div class="stat">
                        <span>Prestige Level:</span>
                        <span class="stat-value" id="prestigeLevel">0</span>
                    </div>
                    <div class="stat">
                        <span>Multiplier:</span>
                        <span class="stat-value" id="totalMultiplier">1x</span>
                    </div>
                    <div class="stat">
                        <span>Prestige Bonus:</span>
                        <span class="stat-value" id="prestigeBonusDisplay">1x</span>
                    </div>
                </div>
            </div>

            <div class="shop-section">
                <h2>üõí BRAINROT UPGRADES üõí</h2>
                <p style="color: #ffd93d; text-align: center; margin-bottom: 15px;">Unlocks at 1.5x cost. 2x Multipliers can only be bought once!</p>
                <div class="shop-grid" id="upgradesGrid">
                    <!-- Upgrades will be generated by JavaScript -->
                </div>
            </div>

            <div class="prestige-section">
                <h2>‚≠ê PRESTIGE SYSTEM ‚≠ê</h2>
                <p>Reset everything for permanent multipliers and new icons!</p>
                <p>Current Requirement: <span id="prestigeRequirement" style="color:#ffd93d; font-weight:bold;">1,000,000</span> Brainrot</p>
                <p class="prestige-icon-info">Current Icon: <span id="currentIconName">Tung Tung Suhur</span></p>
                <p style="color: #ff6b6b; font-weight: bold; margin: 10px 0;">Current Prestige Bonus: <span id="currentPrestigeBonus">1x</span></p>
                <p style="color: #4d96ff; font-size: 0.9em; margin-bottom: 10px;">Next Prestige: <span id="nextPrestigeBonus">2x</span> bonus</p>
                
                <div class="prestige-icons" id="prestigeIcons">
                    <!-- Prestige icons will be generated -->
                </div>
                
                <button id="prestigeBtn" onclick="prestige()" disabled>PRESTIGE (Get 2x Bonus)</button>
            </div>
        </div>

        <!-- LEADERBOARD SECTION -->
        <div id="leaderboardSection" class="content-section">
            <div class="leaderboard-section">
                <div class="leaderboard-container">
                    <div class="leaderboard-header">
                        <h2>üèÜ GLOBAL LEADERBOARD üèÜ</h2>
                        <p class="leaderboard-subtitle">Top 10 Brainrot Masters (REAL Global)</p>
                        <p style="color: #6bcf7f; font-size: 0.9em;">Live updates - See players from around the world!</p>
                    </div>

                    <div class="leaderboard-controls">
                        <button class="leaderboard-btn" onclick="submitToLeaderboard()">üì§ SUBMIT SCORE</button>
                        <button class="leaderboard-btn" onclick="refreshLeaderboard()">üîÑ REFRESH</button>
                        <button class="leaderboard-btn" onclick="changePlayerName()">‚úèÔ∏è CHANGE NAME</button>
                    </div>

                    <div id="leaderboardContent">
                        <!-- Leaderboard content will be generated by JavaScript -->
                    </div>

                    <div class="leaderboard-stats">
                        <div class="your-rank" id="yourRankInfo">Submit your score to join the leaderboard!</div>
                        <div class="total-players" id="totalPlayers">Loading...</div>
                        <div class="refresh-info">Leaderboard updates every 30 seconds</div>
                        <div class="refresh-info" id="lastUpdated"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="logan-mode">
        <button id="loganBtn" onclick="activateLoganMode()">ACTIVATE LOGAN MODE</button>
    </div>

    <script>
        // ========== GAME VARIABLES ==========
        let brainrot = 0;
        let totalBrainrot = 0;
        let lifetimeBrainrot = 0;
        let totalClicks = 0;
        let prestigeLevel = 0;
        let prestigeBonus = 1;
        let loganActive = false;
        let loganTime = 0;
        let totalMultiplier = 1;
        let upgradeCheckInterval = null;
        let playerName = "Player";
        let playerId = null;
        let leaderboardData = [];
        let apiOnline = false;
        
        // ========== API CONFIGURATION ==========
        // Using a free backend service (MockAPI)
        const API_URL = "https://6714a3a5a736983f65f0311b.mockapi.io";
        const LEADERBOARD_ID = "brainrot-leaderboard";
        
        // ========== PRESTIGE ICONS ==========
        const prestigeIcons = [
            { level: 0, emoji: "ü§™", name: "Tung Tung Suhur", color: "#ff6b6b" },
            { level: 1, emoji: "üß†", name: "Brainrot Initiate", color: "#4d96ff" },
            { level: 2, emoji: "üëÅÔ∏è", name: "Third Eye Opening", color: "#9d4edd" },
            { level: 3, emoji: "üåÄ", name: "Mind Vortex", color: "#ffd93d" },
            { level: 4, emoji: "üåà", name: "Rainbow Brain", color: "#6bcf7f" },
            { level: 5, emoji: "üëë", name: "Brainrot King", color: "#ff6b6b" },
            { level: 6, emoji: "üåå", name: "Cosmic Brain", color: "#9d4edd" },
            { level: 7, emoji: "‚ö°", name: "Neural Overload", color: "#ffd93d" },
            { level: 8, emoji: "‚ôæÔ∏è", name: "Infinite Mind", color: "#4d96ff" },
            { level: 9, emoji: "ü¶Ö", name: "Eagle Transcendence", color: "#6bcf7f" },
            { level: 10, emoji: "üëÅÔ∏è‚Äçüó®Ô∏è", name: "Omniscient Being", color: "#ff6b6b" }
        ];
        
        // ========== UPGRADES ==========
        const upgrades = [
            { id: 1, name: "Extra Finger", desc: "+1 Brainrot per click", baseCost: 100, cost: 100, count: 0, power: 1, type: "click", unlockAt: 150, max: 50, multiplier: false },
            { id: 2, name: "Brain Cell", desc: "+2 Brainrot per second", baseCost: 500, cost: 500, count: 0, power: 2, type: "auto", unlockAt: 750, max: 40, multiplier: false },
            { id: 3, name: "2x Multiplier I", desc: "DOUBLES all Brainrot", baseCost: 2500, cost: 2500, count: 0, power: 2, type: "global", unlockAt: 3750, max: 1, multiplier: true },
            { id: 4, name: "Coffee Boost", desc: "+10 Brainrot per click", baseCost: 5000, cost: 5000, count: 0, power: 10, type: "click", unlockAt: 7500, max: 30, multiplier: false },
            { id: 5, name: "2x Multiplier II", desc: "DOUBLES all Brainrot", baseCost: 25000, cost: 25000, count: 0, power: 2, type: "global", unlockAt: 37500, max: 1, multiplier: true },
            { id: 6, name: "Brain Farm", desc: "+50 Brainrot per second", baseCost: 50000, cost: 50000, count: 0, power: 50, type: "auto", unlockAt: 75000, max: 20, multiplier: false },
            { id: 7, name: "2x Multiplier III", desc: "DOUBLES all Brainrot", baseCost: 250000, cost: 250000, count: 0, power: 2, type: "global", unlockAt: 375000, max: 1, multiplier: true },
            { id: 8, name: "Adderall", desc: "+100 Brainrot per click", baseCost: 500000, cost: 500000, count: 0, power: 100, type: "click", unlockAt: 750000, max: 15, multiplier: false },
            { id: 9, name: "2x Multiplier IV", desc: "DOUBLES all Brainrot", baseCost: 2500000, cost: 2500000, count: 0, power: 2, type: "global", unlockAt: 3750000, max: 1, multiplier: true },
            { id: 10, name: "Synapse Cluster", desc: "+500 Brainrot per second", baseCost: 5000000, cost: 5000000, count: 0, power: 500, type: "auto", unlockAt: 7500000, max: 10, multiplier: false },
            { id: 11, name: "2x Multiplier V", desc: "DOUBLES all Brainrot", baseCost: 25000000, cost: 25000000, count: 0, power: 2, type: "global", unlockAt: 37500000, max: 1, multiplier: true },
            { id: 12, name: "God Complex", desc: "+1,000 Brainrot per click", baseCost: 50000000, cost: 50000000, count: 0, power: 1000, type: "click", unlockAt: 75000000, max: 8, multiplier: false },
            { id: 13, name: "2x Multiplier VI", desc: "DOUBLES all Brainrot", baseCost: 250000000, cost: 250000000, count: 0, power: 2, type: "global", unlockAt: 375000000, max: 1, multiplier: true },
            { id: 14, name: "Neural Network", desc: "+5,000 Brainrot per second", baseCost: 500000000, cost: 500000000, count: 0, power: 5000, type: "auto", unlockAt: 750000000, max: 5, multiplier: false },
            { id: 15, name: "2x Multiplier VII", desc: "DOUBLES all Brainrot", baseCost: 2500000000, cost: 2500000000, count: 0, power: 2, type: "global", unlockAt: 3750000000, max: 1, multiplier: true },
            { id: 16, name: "Reality Warper", desc: "+10,000 Brainrot per click", baseCost: 5000000000, cost: 5000000000, count: 0, power: 10000, type: "click", unlockAt: 7500000000, max: 5, multiplier: false },
            { id: 17, name: "2x Multiplier VIII", desc: "DOUBLES all Brainrot", baseCost: 25000000000, cost: 25000000000, count: 0, power: 2, type: "global", unlockAt: 37500000000, max: 1, multiplier: true },
            { id: 18, name: "Brainrot Singularity", desc: "+50,000 Brainrot per second", baseCost: 50000000000, cost: 50000000000, count: 0, power: 50000, type: "auto", unlockAt: 75000000000, max: 3, multiplier: false },
            { id: 19, name: "2x Multiplier IX", desc: "DOUBLES all Brainrot", baseCost: 250000000000, cost: 250000000000, count: 0, power: 2, type: "global", unlockAt: 375000000000, max: 1, multiplier: true },
            { id: 20, name: "Omni-Click", desc: "+100,000 Brainrot per click", baseCost: 500000000000, cost: 500000000000, count: 0, power: 100000, type: "click", unlockAt: 750000000000, max: 3, multiplier: false },
            { id: 21, name: "2x Multiplier X", desc: "FINAL DOUBLE", baseCost: 1000000000000, cost: 1000000000000, count: 0, power: 2, type: "global", unlockAt: 1500000000000, max: 1, multiplier: true }
        ];

        // ========== API FUNCTIONS ==========
        async function testAPI() {
            try {
                const response = await fetch(`${API_URL}/test`, { 
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                });
                apiOnline = true;
                updateAPIStatus("Connected to global leaderboard", "online");
                return true;
            } catch (error) {
                apiOnline = false;
                updateAPIStatus("Using local leaderboard", "offline");
                return false;
            }
        }

        async function getLeaderboardFromAPI() {
            if (!apiOnline) return null;
            
            try {
                const response = await fetch(`${API_URL}/leaderboard`, {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    // MockAPI returns array of objects
                    return data.map(item => ({
                        name: item.name || "Player",
                        score: item.score || 0,
                        prestige: item.prestige || 0,
                        timestamp: item.createdAt || Date.now()
                    }));
                }
                return null;
            } catch (error) {
                console.log("API fetch error, using local:", error);
                return null;
            }
        }

        async function submitScoreToAPI(name, score, prestige) {
            if (!apiOnline) return false;
            
            try {
                const playerData = {
                    name: name,
                    score: score,
                    prestige: prestige,
                    createdAt: Date.now()
                };
                
                const response = await fetch(`${API_URL}/leaderboard`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(playerData)
                });
                
                return response.ok;
            } catch (error) {
                console.log("API submit error:", error);
                return false;
            }
        }

        function updateAPIStatus(message, status) {
            const statusEl = document.getElementById('apiStatus');
            const dot = document.getElementById('statusDot');
            const text = document.getElementById('statusText');
            
            if (statusEl && dot && text) {
                statusEl.style.display = 'flex';
                dot.className = 'status-dot';
                dot.classList.add(status === 'online' ? 'status-online' : 'status-offline');
                text.textContent = message;
            }
        }

        // ========== LOCAL STORAGE FALLBACK ==========
        function getLocalLeaderboard() {
            try {
                const saved = localStorage.getItem('brainrot_local_leaderboard');
                if (saved) {
                    return JSON.parse(saved);
                }
            } catch (e) {
                console.log("Error reading local leaderboard:", e);
            }
            return [];
        }

        function saveLocalLeaderboard(data) {
            try {
                localStorage.setItem('brainrot_local_leaderboard', JSON.stringify(data));
            } catch (e) {
                console.log("Error saving local leaderboard:", e);
            }
        }

        // ========== GAME INITIALIZATION ==========
        async function startGame() {
            const nameInput = document.getElementById('playerNameInput');
            const name = nameInput.value.trim();
            
            if (!name) {
                alert('Please enter your name!');
                return;
            }
            
            playerName = name.substring(0, 20);
            playerId = 'player_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('brainrot_player_name', playerName);
            localStorage.setItem('brainrot_player_id', playerId);
            
            // Test API connection
            await testAPI();
            
            // Hide login, show game
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'block';
            document.getElementById('playerInfo').style.display = 'block';
            document.getElementById('playerNameDisplay').textContent = playerName;
            
            // Load saved game
            loadGame();
            
            // Initialize game
            updateMainIcon();
            createUpgradeElements();
            createPrestigeIcons();
            updateDisplay();
            gameLoop();
            
            // Load leaderboard
            await refreshLeaderboard();
            
            // Start upgrade check interval
            upgradeCheckInterval = setInterval(createUpgradeElements, 1000);
            
            // Auto-refresh leaderboard every 30 seconds
            setInterval(async () => {
                if (document.getElementById('leaderboardSection').classList.contains('active')) {
                    await refreshLeaderboard();
                }
            }, 30000);
            
            showAchievement(`Welcome ${playerName}! Let's rot some brains!`);
        }

        // ========== GAME FUNCTIONS ==========
        function clickBrainrot() {
            let clickPower = 1;
            upgrades.forEach(upgrade => {
                if (upgrade.type === "click" && upgrade.count > 0) {
                    clickPower += upgrade.power * upgrade.count;
                }
            });
            
            clickPower *= totalMultiplier;
            clickPower *= prestigeBonus;
            
            if (loganActive) {
                clickPower *= 10;
            }
            
            brainrot += clickPower;
            totalBrainrot += clickPower;
            lifetimeBrainrot += clickPower;
            totalClicks++;
            
            createClickEffect(clickPower);
            createParticles(3);
            checkAchievements();
            updateDisplay();
            saveGame();
        }

        function createUpgradeElements() {
            const grid = document.getElementById('upgradesGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            upgrades.forEach(upgrade => {
                const isUnlocked = totalBrainrot >= (upgrade.baseCost * 1.5);
                const canAfford = brainrot >= upgrade.cost;
                const isMaxed = upgrade.count >= upgrade.max;
                const isBought = upgrade.count > 0;
                
                const item = document.createElement('div');
                item.className = `upgrade-item ${isUnlocked ? 'unlocked' : 'locked'} ${isBought ? 'bought' : ''}`;
                
                if (upgrade.multiplier) {
                    item.style.background = 'rgba(255, 215, 61, 0.1)';
                    item.style.border = '2px solid #ffd93d';
                }
                
                item.innerHTML = `
                    <div class="upgrade-name">${upgrade.name} ${isMaxed ? '‚úÖ' : ''}</div>
                    <div class="upgrade-desc">${upgrade.desc}</div>
                    <div class="upgrade-requirement">Unlocks at: ${formatNumber(upgrade.baseCost * 1.5)} Total Brainrot</div>
                    <div class="upgrade-cost">Cost: ${formatNumber(upgrade.cost)} üß†</div>
                    <div class="upgrade-count">${upgrade.multiplier ? 'One-time 2x' : `Owned: ${upgrade.count}/${upgrade.max}`}</div>
                `;
                
                if (isUnlocked && !isMaxed && canAfford) {
                    item.onclick = () => buyUpgrade(upgrade.id);
                    item.style.cursor = 'pointer';
                    item.style.opacity = '1';
                } else if (isMaxed) {
                    item.style.background = 'rgba(107, 207, 127, 0.3)';
                    item.style.borderColor = '#6bcf7f';
                    item.style.cursor = 'default';
                } else if (!isUnlocked) {
                    item.style.cursor = 'default';
                    item.style.opacity = '0.5';
                } else if (isUnlocked && !canAfford) {
                    item.style.cursor = 'default';
                    item.style.opacity = '0.8';
                }
                
                grid.appendChild(item);
            });
        }

        function buyUpgrade(id) {
            const upgrade = upgrades.find(u => u.id === id);
            if (!upgrade) return;
            
            if (brainrot >= upgrade.cost && upgrade.count < upgrade.max) {
                brainrot -= upgrade.cost;
                upgrade.count++;
                
                if (upgrade.multiplier) {
                    totalMultiplier *= 2;
                    showAchievement(`2X MULTIPLIER UNLOCKED!`);
                    createParticles(25);
                    document.getElementById('mainIcon').style.animation = 'pulse 0.5s';
                    setTimeout(() => {
                        document.getElementById('mainIcon').style.animation = '';
                    }, 500);
                }
                
                if (!upgrade.multiplier) {
                    upgrade.cost = Math.floor(upgrade.cost * 2.5);
                }
                
                updateDisplay();
                createUpgradeElements();
                saveGame();
            }
        }

        function calculateBPS() {
            let bps = 0;
            upgrades.forEach(upgrade => {
                if (upgrade.type === "auto" && upgrade.count > 0) {
                    bps += upgrade.power * upgrade.count;
                }
            });
            bps *= totalMultiplier;
            bps *= prestigeBonus;
            if (loganActive) bps *= 10;
            return bps;
        }

        function calculateClickPower() {
            let power = 1;
            upgrades.forEach(upgrade => {
                if (upgrade.type === "click" && upgrade.count > 0) {
                    power += upgrade.power * upgrade.count;
                }
            });
            power *= totalMultiplier;
            power *= prestigeBonus;
            if (loganActive) power *= 10;
            return power;
        }

        function gameLoop() {
            const bps = calculateBPS();
            if (bps > 0) {
                brainrot += bps / 10;
                totalBrainrot += bps / 10;
                lifetimeBrainrot += bps / 10;
            }
            
            if (loganActive) {
                loganTime--;
                if (loganTime <= 0) {
                    loganActive = false;
                    const btn = document.getElementById('loganBtn');
                    btn.textContent = 'ACTIVATE LOGAN MODE';
                    btn.style.animation = 'loganPulse 2s infinite';
                    document.body.style.animation = '';
                }
            }
            
            const required = 1000000 * Math.pow(10, prestigeLevel);
            const prestigeBtn = document.getElementById('prestigeBtn');
            
            if (prestigeBtn) {
                if (brainrot >= required) {
                    prestigeBtn.disabled = false;
                    const nextBonus = prestigeLevel + 2;
                    prestigeBtn.textContent = `PRESTIGE (Get ${nextBonus}x Bonus)`;
                    prestigeBtn.style.background = `linear-gradient(45deg, #6bcf7f, #4d96ff)`;
                } else {
                    prestigeBtn.disabled = true;
                    prestigeBtn.textContent = `PRESTIGE (Need ${formatNumber(required - brainrot)} more)`;
                    prestigeBtn.style.background = `linear-gradient(45deg, #9d4edd, #ff6b6b)`;
                }
            }
            
            const fillPercent = Math.min((brainrot / required) * 100, 100);
            const brainrotFill = document.getElementById('brainrotFill');
            if (brainrotFill) {
                brainrotFill.style.width = `${fillPercent}%`;
            }
            
            updateDisplay();
            setTimeout(gameLoop, 100);
        }

        function createPrestigeIcons() {
            const container = document.getElementById('prestigeIcons');
            if (!container) return;
            
            container.innerHTML = '';
            
            prestigeIcons.forEach((icon, index) => {
                const iconEl = document.createElement('div');
                iconEl.className = `prestige-icon ${index <= prestigeLevel ? 'active' : ''}`;
                iconEl.textContent = icon.emoji;
                iconEl.style.color = icon.color;
                iconEl.title = `${icon.name} (Level ${icon.level})`;
                container.appendChild(iconEl);
            });
        }

        function updateMainIcon() {
            const icon = document.getElementById('mainIcon');
            const currentIconName = document.getElementById('currentIconName');
            
            if (!icon || !currentIconName) return;
            
            const currentIcon = prestigeIcons[Math.min(prestigeLevel, prestigeIcons.length - 1)];
            
            icon.innerHTML = currentIcon.emoji;
            icon.style.background = `linear-gradient(45deg, ${currentIcon.color}, ${getRandomColor()})`;
            icon.style.boxShadow = `0 0 60px ${currentIcon.color}80`;
            
            currentIconName.textContent = currentIcon.name;
            currentIconName.style.color = currentIcon.color;
        }

        function prestige() {
            const required = 1000000 * Math.pow(10, prestigeLevel);
            
            if (brainrot >= required) {
                prestigeLevel++;
                prestigeBonus = prestigeLevel + 1;
                
                brainrot = 0;
                totalBrainrot = 0;
                totalClicks = 0;
                totalMultiplier = 1;
                
                upgrades.forEach(upgrade => {
                    upgrade.count = 0;
                    upgrade.cost = upgrade.baseCost;
                });
                
                updateMainIcon();
                createPrestigeIcons();
                
                const iconName = prestigeIcons[Math.min(prestigeLevel, prestigeIcons.length - 1)].name;
                showAchievement(`PRESTIGE ${prestigeLevel}! ${prestigeBonus}x MULTIPLIER!`);
                showAchievement(`Lifetime Brainrot: ${formatNumber(lifetimeBrainrot)}!`);
                createParticles(50);
                
                updateDisplay();
                createUpgradeElements();
                saveGame();
            }
        }

        function activateLoganMode() {
            if (!loganActive) {
                loganActive = true;
                loganTime = 300;
                
                const btn = document.getElementById('loganBtn');
                if (btn) {
                    btn.textContent = 'LOGAN MODE ACTIVE!';
                    btn.style.animation = 'none';
                    btn.style.background = 'linear-gradient(45deg, #00ff00, #ffff00, #ff0000)';
                }
                
                document.body.style.animation = 'loganModePulse 0.3s infinite';
                
                setTimeout(() => {
                    loganActive = false;
                    if (btn) {
                        btn.textContent = 'ACTIVATE LOGAN MODE';
                        btn.style.background = 'linear-gradient(45deg, #ff0000, #ffff00, #00ff00)';
                        btn.style.animation = 'loganPulse 2s infinite';
                    }
                    document.body.style.animation = '';
                }, 30000);
            }
        }

        function checkAchievements() {
            const achievements = [
                { check: () => lifetimeBrainrot >= 1000, text: "1K Lifetime Brainrot!" },
                { check: () => lifetimeBrainrot >= 10000, text: "10K Lifetime Brainrot!!" },
                { check: () => lifetimeBrainrot >= 100000, text: "100K Lifetime Brainrot!!!" },
                { check: () => lifetimeBrainrot >= 1000000, text: "1 MILLION Lifetime Brainrot!!!" },
                { check: () => lifetimeBrainrot >= 1000000000, text: "1 BILLION Lifetime Brainrot!!!" },
                { check: () => lifetimeBrainrot >= 1000000000000, text: "1 TRILLION Lifetime Brainrot!!!" },
                { check: () => totalClicks >= 100, text: "100 Clicks!" },
                { check: () => upgrades.some(u => u.multiplier && u.count > 0), text: "First 2x Multiplier!" },
                { check: () => prestigeLevel >= 1, text: "First Prestige!" },
                { check: () => prestigeLevel >= 5, text: "Prestige Master!" },
                { check: () => prestigeLevel >= 10, text: "MAX PRESTIGE!" }
            ];
            
            achievements.forEach(achievement => {
                if (achievement.check() && !localStorage.getItem(`achievement_${achievement.text}`)) {
                    showAchievement(achievement.text);
                    localStorage.setItem(`achievement_${achievement.text}`, 'true');
                }
            });
        }

        function showAchievement(text) {
            const popup = document.createElement('div');
            popup.className = 'achievement-popup';
            popup.textContent = `üèÜ ${text}`;
            document.body.appendChild(popup);
            
            setTimeout(() => popup.remove(), 3000);
        }

        function createClickEffect(amount) {
            const effects = document.getElementById('effects');
            if (!effects) return;
            
            const effect = document.createElement('div');
            effect.className = 'click-effect';
            effect.textContent = `+${formatNumber(amount)} üß†`;
            effect.style.left = `${50 + (Math.random() * 20 - 10)}%`;
            effect.style.top = `${50 + (Math.random() * 20 - 10)}%`;
            effect.style.color = getRandomColor();
            effects.appendChild(effect);
            
            setTimeout(() => effect.remove(), 1200);
        }

        function createParticles(count) {
            const effects = document.getElementById('effects');
            const icon = document.getElementById('mainIcon');
            if (!effects || !icon) return;
            
            const rect = icon.getBoundingClientRect();
            
            for (let i = 0; i < count; i++) {
                const particle = document.createElement('div');
                particle.className = 'brainrot-particle';
                particle.style.left = (rect.left + rect.width / 2) + 'px';
                particle.style.top = (rect.top + rect.height / 2) + 'px';
                particle.style.setProperty('--tx', (Math.random() * 200 - 100) + 'px');
                particle.style.setProperty('--ty', (Math.random() * 200 - 100) + 'px');
                particle.style.background = `linear-gradient(45deg, ${getRandomColor()}, ${getRandomColor()})`;
                effects.appendChild(particle);
                
                setTimeout(() => particle.remove(), 2500);
            }
        }

        function getRandomColor() {
            const colors = ['#ff6b6b', '#4d96ff', '#6bcf7f', '#ffd93d', '#9d4edd'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function updateDisplay() {
            const elements = {
                'currentBrainrot': brainrot,
                'totalBrainrot': totalBrainrot,
                'lifetimeBrainrot': lifetimeBrainrot,
                'totalClicks': totalClicks,
                'prestigeLevel': prestigeLevel,
                'clickPower': calculateClickPower(),
                'bps': calculateBPS(),
                'totalMultiplier': totalMultiplier + 'x',
                'prestigeBonusDisplay': prestigeBonus + 'x',
                'currentPrestigeBonus': prestigeBonus + 'x',
                'nextPrestigeBonus': (prestigeLevel + 2) + 'x',
                'prestigeRequirement': 1000000 * Math.pow(10, prestigeLevel)
            };
            
            Object.keys(elements).forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    if (id === 'totalMultiplier' || id === 'prestigeBonusDisplay' || id === 'currentPrestigeBonus' || id === 'nextPrestigeBonus') {
                        element.textContent = elements[id];
                    } else {
                        element.textContent = formatNumber(elements[id]);
                    }
                }
            });
        }

        function formatNumber(num) {
            if (num >= 1e12) return (num / 1e12).toFixed(2) + 'T';
            if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';
            return Math.floor(num);
        }

        // ========== SAVE/LOAD SYSTEM ==========
        function saveGame() {
            const gameData = {
                brainrot,
                totalBrainrot,
                lifetimeBrainrot,
                totalClicks,
                prestigeLevel,
                totalMultiplier,
                upgrades: upgrades.map(u => ({ 
                    id: u.id, 
                    count: u.count, 
                    cost: u.cost
                }))
            };
            
            localStorage.setItem('brainrot_game_data', JSON.stringify(gameData));
        }

        function loadGame() {
            const saved = localStorage.getItem('brainrot_game_data');
            if (saved) {
                const gameData = JSON.parse(saved);
                
                brainrot = gameData.brainrot || 0;
                totalBrainrot = gameData.totalBrainrot || 0;
                lifetimeBrainrot = gameData.lifetimeBrainrot || 0;
                totalClicks = gameData.totalClicks || 0;
                prestigeLevel = gameData.prestigeLevel || 0;
                totalMultiplier = gameData.totalMultiplier || 1;
                prestigeBonus = (gameData.prestigeLevel || 0) + 1;
                
                if (gameData.upgrades) {
                    gameData.upgrades.forEach(savedUpgrade => {
                        const upgrade = upgrades.find(u => u.id === savedUpgrade.id);
                        if (upgrade) {
                            upgrade.count = savedUpgrade.count || 0;
                            upgrade.cost = savedUpgrade.cost || upgrade.baseCost;
                        }
                    });
                }
            }
            
            // Load player info
            const savedName = localStorage.getItem('brainrot_player_name');
            const savedId = localStorage.getItem('brainrot_player_id');
            if (savedName) {
                playerName = savedName;
                document.getElementById('playerNameInput').value = playerName;
            }
            if (savedId) {
                playerId = savedId;
            }
        }

        // ========== LEADERBOARD SYSTEM ==========
        async function submitToLeaderboard() {
            if (lifetimeBrainrot === 0) {
                showAchievement("You need to earn some brainrot first!");
                return;
            }
            
            showAchievement("Submitting score to global leaderboard...");
            
            let success = false;
            
            // Try API first
            if (apiOnline) {
                success = await submitScoreToAPI(playerName, lifetimeBrainrot, prestigeLevel);
                if (success) {
                    showAchievement("Score submitted to GLOBAL leaderboard! üéâ");
                }
            }
            
            // Always save locally too
            const localLeaderboard = getLocalLeaderboard();
            const existingIndex = localLeaderboard.findIndex(entry => entry.name === playerName);
            
            if (existingIndex !== -1) {
                if (lifetimeBrainrot > localLeaderboard[existingIndex].score) {
                    localLeaderboard[existingIndex] = {
                        name: playerName,
                        score: lifetimeBrainrot,
                        prestige: prestigeLevel,
                        timestamp: Date.now()
                    };
                }
            } else {
                localLeaderboard.push({
                    name: playerName,
                    score: lifetimeBrainrot,
                    prestige: prestigeLevel,
                    timestamp: Date.now()
                });
            }
            
            localLeaderboard.sort((a, b) => b.score - a.score);
            if (localLeaderboard.length > 50) {
                localLeaderboard.length = 50;
            }
            
            saveLocalLeaderboard(localLeaderboard);
            
            if (!apiOnline && !success) {
                showAchievement("Score saved to local leaderboard");
            }
            
            createParticles(10);
            await refreshLeaderboard();
        }

        async function refreshLeaderboard() {
            const lastUpdatedEl = document.getElementById('lastUpdated');
            if (lastUpdatedEl) {
                lastUpdatedEl.textContent = `Last updated: ${new Date().toLocaleTimeString()}`;
            }
            
            let apiData = null;
            let localData = getLocalLeaderboard();
            
            // Try to get data from API
            if (apiOnline) {
                apiData = await getLeaderboardFromAPI();
            }
            
            // Combine and deduplicate data
            leaderboardData = [];
            const seenNames = new Set();
            
            // Add API data first
            if (apiData && apiData.length > 0) {
                apiData.forEach(entry => {
                    if (!seenNames.has(entry.name)) {
                        leaderboardData.push(entry);
                        seenNames.add(entry.name);
                    }
                });
            }
            
            // Add local data for offline players
            localData.forEach(entry => {
                if (!seenNames.has(entry.name)) {
                    leaderboardData.push(entry);
                    seenNames.add(entry.name);
                }
            });
            
            // Sort by score
            leaderboardData.sort((a, b) => b.score - a.score);
            
            // Keep top 20
            if (leaderboardData.length > 20) {
                leaderboardData.length = 20;
            }
            
            updateLeaderboardDisplay();
        }

        function updateLeaderboardDisplay() {
            const contentDiv = document.getElementById('leaderboardContent');
            const totalPlayersEl = document.getElementById('totalPlayers');
            const yourRankInfoEl = document.getElementById('yourRankInfo');
            
            if (!contentDiv || !totalPlayersEl || !yourRankInfoEl) return;
            
            // Update total players
            totalPlayersEl.textContent = `Total Players: ${leaderboardData.length}`;
            
            // Find player's rank
            const playerIndex = leaderboardData.findIndex(entry => entry.name === playerName);
            if (playerIndex !== -1) {
                const rank = playerIndex + 1;
                const score = leaderboardData[playerIndex].score;
                yourRankInfoEl.textContent = `Your Rank: #${rank} with ${formatNumber(score)} lifetime brainrot`;
                yourRankInfoEl.style.color = '#6bcf7f';
            } else {
                yourRankInfoEl.textContent = `Submit your score to join the leaderboard!`;
                yourRankInfoEl.style.color = '#ffd93d';
            }
            
            // Show leaderboard table
            if (leaderboardData.length === 0) {
                contentDiv.innerHTML = `
                    <div class="empty-leaderboard">
                        <span class="emoji">üèÜ</span>
                        <p>No players yet!</p>
                        <p>Be the first to submit your score!</p>
                        <p style="font-size: 0.9em; color: #4d96ff; margin-top: 20px;">
                            ${apiOnline ? 'Global leaderboard ready!' : 'Playing offline - connect for global leaderboard'}
                        </p>
                    </div>
                `;
                return;
            }
            
            // Create table
            const top10 = leaderboardData.slice(0, 10);
            let tableHTML = `
                <table class="leaderboard-table">
                    <thead>
                        <tr>
                            <th width="60">Rank</th>
                            <th>Player</th>
                            <th width="180">Lifetime Brainrot</th>
                            <th width="100">Prestige</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            top10.forEach((entry, index) => {
                let rowClass = '';
                if (index === 0) rowClass = 'rank-1';
                else if (index === 1) rowClass = 'rank-2';
                else if (index === 2) rowClass = 'rank-3';
                else rowClass = 'rank-4-10';
                
                let rowStyle = '';
                if (entry.name === playerName) {
                    rowStyle = 'background: rgba(107, 207, 127, 0.3); font-weight: bold;';
                }
                
                tableHTML += `
                    <tr class="${rowClass}" style="${rowStyle}">
                        <td>
                            <div class="rank-badge">${index + 1}</div>
                        </td>
                        <td class="player-name">${entry.name}</td>
                        <td class="player-score">${formatNumber(entry.score)} üß†</td>
                        <td class="player-prestige">${entry.prestige || 0} ‚≠ê</td>
                    </tr>
                `;
            });
            
            tableHTML += `</tbody></table>`;
            contentDiv.innerHTML = tableHTML;
        }

        function changePlayerName() {
            const newName = prompt("Enter your new display name (max 20 chars):", playerName);
            if (newName === null) return;
            
            if (newName && newName.trim() !== "") {
                const trimmedName = newName.trim().substring(0, 20);
                playerName = trimmedName;
                localStorage.setItem('brainrot_player_name', playerName);
                document.getElementById('playerNameDisplay').textContent = playerName;
                showAchievement(`Name changed to: ${playerName}`);
            }
        }

        // ========== TAB SYSTEM ==========
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.getElementById(tabName + 'Section').classList.add('active');
            
            if (tabName === 'leaderboard') {
                refreshLeaderboard();
            }
        }

        // ========== AUTO-LOAD ==========
        window.onload = function() {
            // Load saved player info
            loadGame();
            
            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes loganModePulse {
                    0%, 100% { filter: hue-rotate(0deg) brightness(1.2); }
                    50% { filter: hue-rotate(180deg) brightness(1.5); }
                }
                
                @keyframes pulse {
                    0% { transform: scale(1); }
                    50% { transform: scale(1.1); }
                    100% { transform: scale(1); }
                }
                
                #mainIcon:hover {
                    transform: scale(1.05);
                }
            `;
            document.head.appendChild(style);
        };
    </script>
</body>
</html>
